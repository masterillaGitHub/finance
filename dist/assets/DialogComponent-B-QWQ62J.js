import{I as w,J as N,_ as O,j as k,n as g,r as f,o as l,c as y,a as S,t as C,k as d,e as I,w as A,K as j,L as q,f as D,x as L,d as x,F as V,z as M,N as R,H as T,O as E,b as P}from"./index-BCfnNAGH.js";import{b as $,i as B,C as _,d as z,e as U,v as H,A as J}from"./entities-BuFZRM3B.js";import{_ as K,a as G}from"./CurrenciesList-CUSLOgvq.js";const ae=w("accounts/index",{state:()=>({amountTotal:0,accountsPanelModel:[],categoriesIds:[]}),getters:{},actions:{addCategoryId(e){this.categoriesIds.indexOf(e)===-1&&this.categoriesIds.push(e)}}});function oe(e){return N(e)?!0:"Поле не може бути пустим."}function ue(e){const t=async()=>{const{valid:c}=await e.value.validate();return c},n=()=>e.value.resetValidation();return{validate:t,resetValidation:n,check:async()=>(n(),await t())}}const Q={class:"d-flex align-center s-item"},W={class:"d-flex align-center"},X={class:"mr-2"},Y={key:0,class:"align-self-center"},Z={__name:"AccountSumItem",props:{accountSum:{type:Object,required:!0,validator:e=>e instanceof $},isAvailableRemove:{type:Boolean,required:!1}},emits:{removeAccountSum:B},setup(e,{emit:t}){const n=e,u=t,c=k(!1),a=g(()=>n.accountSum.balance??0),r=g(()=>_.find(n.accountSum.getRelation("currency")));function p(m){z(n.accountSum,{balance:m})}return(m,s)=>{const h=f("v-btn");return l(),y("div",Q,[S("div",W,"Баланс ("+C(r.value.alphabetic_code)+")",1),S("div",{class:"flex-grow-1 d-flex justify-end align-center text-h6",onClick:s[2]||(s[2]=i=>c.value=!0)},[S("span",X,C(a.value),1),S("span",null,C(r.value.symbol),1),d(K,{modelValue:c.value,"onUpdate:modelValue":s[0]||(s[0]=i=>c.value=i),"start-sum":a.value,onDone:s[1]||(s[1]=i=>p(i))},null,8,["modelValue","start-sum"])]),e.isAvailableRemove?(l(),y("div",Y,[d(h,{variant:"text",icon:"mdi-close",onClick:s[3]||(s[3]=i=>u("removeAccountSum",e.accountSum))})])):I("",!0)])}}},ee=O(Z,[["__scopeId","data-v-2df19aa5"]]),te={__name:"TheAddAccountSum",emits:{selectedCurrency:U},setup(e,{emit:t}){const n=t,u=g(()=>_.all());return(c,a)=>{const r=f("v-divider"),p=f("v-btn"),m=f("v-menu");return l(),y("div",null,[d(r,{class:"mb-3"}),d(m,null,{activator:A(({props:s})=>[d(p,j(q(s)),{default:A(()=>[D(" Додати валюту ")]),_:2},1040)]),default:A(()=>[d(G,{currencies:u.value,onSelected:a[0]||(a[0]=s=>n("selectedCurrency",s))},null,8,["currencies"])]),_:1})])}}},re={__name:"TheAccountSums",props:{accountSums:{type:Array,required:!0,validator:H},isCreateFirst:{type:Boolean,default:!1}},emits:{createdAccountSum:B},setup(e,{emit:t}){const n=e,u=t,c=k(!1),a=g(()=>_.findLoaded());L(()=>{r()});async function r(){a.value.length!==3&&await m(),n.isCreateFirst&&p()}function p(){const o=_.all();i(o[0])}async function m(){c.value=!0;try{await _.sync()}finally{c.value=!1}}function s(o){h(o)||i(o)}function h(o){return n.accountSums.some(v=>v.currency.id===o.id)}function i(o){const v=new $;v.balance=0,v.currency=o.id,u("createdAccountSum",v)}return(o,v)=>{const F=f("v-progress-linear");return l(),y(V,null,[c.value?(l(),x(F,{key:0,indeterminate:""})):I("",!0),(l(!0),y(V,null,M(e.accountSums,b=>(l(),x(ee,{key:b.id,"account-sum":b},null,8,["account-sum"]))),128)),d(te,{onSelectedCurrency:s})],64)}}},ie=w("accounts/create",{state:()=>({account:null,sums:[]}),getters:{},actions:{createAccount(e){const t=new J;t.category=e,this.account=t},reset(){this.resetAccount(),this.resetAccountSum(),console.info("account and account sums were reset")},resetAccount(){this.account=null},resetAccountSum(){this.sums=[]},createAccountSum(e){this.sums.push(e)},deleteAccountSum(e){this.sums.splice(this.sums.indexOf(e),1)},async saveAccount(){this.account.currency=this.sums[0].currency.id;const e=await this.account.save({include:"sums,category"});await this.saveAccountSums(e)},async saveAccountSums(e){if(e)for(const t of this.sums)t.account=e,await t.save({include:"currency"})}}}),le={__name:"DialogComponent",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(e){const{mobile:t}=R(),n=T(e,"modelValue");return(u,c)=>{const a=f("v-dialog");return l(),x(a,{"max-width":"600",fullscreen:P(t),modelValue:n.value,"onUpdate:modelValue":c[0]||(c[0]=r=>n.value=r)},{default:A(()=>[E(u.$slots,"default")]),_:3},8,["fullscreen","modelValue"])}}};export{re as _,ie as a,ue as b,le as c,oe as r,ae as u};
