import{c as b,T as k}from"./Transaction-3bVJcTy4.js";import{c as D}from"./entities-pc8Wm9KT.js";import{_ as E,n as _,T as N,r as h,o as d,c as p,a as s,k as i,w as z,t as m,x,e as y,i as A,B as I,F as P,y as B,l as C,d as S,J as j,q as O,G as $,K as F,M as G,A as V,L as q}from"./index-7TYs6_Yt.js";const M={class:"d-flex justify-space-between"},R={class:"pa-2"},U={class:"d-flex flex-column flex-grow-1",style:{"min-width":"0"}},H={class:"d-flex flex-wrap flex-grow-1"},J={class:"s-text-truncate-wrapper mr-3"},K={class:"font-weight-bold text-truncate"},Y={class:"d-flex"},Z={key:0},Q={class:"text-green"},W={class:"d-flex text-grey-darken-1"},X={class:"text-truncate"},tt={key:0,class:"d-flex s-min-width-0 s-max-width-70"},et={class:"text-truncate"},at={__name:"TransactionItem",props:{t:{type:Object,required:!0,validator:D}},setup(t){const e=t,a=_(()=>c(e.t.amount,e.t.currency.alphabetic_code)),l=_(()=>c(e.t.to_amount,e.t.to_currency.alphabetic_code)),o=_(()=>e.t.amount>0),n=_(()=>e.t.type.id===N);function c(u,f){return b(u,f,{signDisplay:"exceptZero"}).replace("-","")}return(u,f)=>{var g,v;const r=h("v-icon"),T=h("v-avatar");return d(),p("div",M,[s("div",R,[i(T,{size:"small"},{default:z(()=>[i(r,{size:"large",icon:t.t.category.icon},null,8,["icon"])]),_:1})]),s("div",U,[s("div",H,[s("div",J,[s("div",K,m(t.t.category.name),1)]),s("div",Y,[s("div",{class:x({"text-green":o.value})},m(a.value),3),n.value&&t.t.currency.id!==t.t.to_currency.id?(d(),p("div",Z,[i(r,{icon:"mdi-arrow-right-thin",class:"mx-1 text-grey-darken-1"}),s("span",Q,m(l.value),1)])):y("",!0)])]),s("div",W,[s("div",{class:x(["d-flex s-min-width-0",[n.value?"s-max-width-70":"w-100"]])},[i(r,{icon:t.t.account.getIcon(),class:"mr-2"},null,8,["icon"]),s("span",X,m(t.t.account.name),1)],2),n.value?(d(),p("div",tt,[i(r,{icon:"mdi-arrow-right-thin",class:"mx-1"}),i(r,{icon:(g=t.t.to_account)==null?void 0:g.getIcon(),class:"mr-2"},null,8,["icon"]),s("span",et,m((v=t.t.to_account)==null?void 0:v.name),1)])):y("",!0)])])])}}},st=E(at,[["__scopeId","data-v-2e8f3559"]]),nt={class:"s-group"},ot={class:"text-grey my-3"},ut={__name:"TransactionGroup",props:{group:Object},setup(t){const e=A(),a=l=>{e.push({name:"transactions.edit",params:{id:l.id}})};return(l,o)=>{const n=I("ripple");return d(),p("div",nt,[s("div",ot,m(t.group.date),1),(d(!0),p(P,null,B(t.group.transactions,c=>C((d(),S(st,{class:"py-1",t:c,onClick:u=>a(c)},null,8,["t","onClick"])),[[n]])),256))])}}},ct={key:0,class:"mt-8 h-3 text-center"},mt={__name:"TheBottomLazyLoading",props:{show:{type:Number,default:100},load:{type:Number,default:100},enable:{type:Boolean,default:!1}},emits:["load"],setup(t,{emit:e}){const a=t,l=e,o=j(),n=_(()=>o.offsetTopPercent>=a.show&&o.offsetTop>0),c=_(()=>n.value||o.offsetTop>0&&o.offsetTopPercent>=a.load);return O(c,u=>{u===!0&&a.enable&&l("load")}),(u,f)=>{const r=h("v-progress-circular");return n.value&&t.enable?(d(),p("div",ct,[i(r,{indeterminate:""})])):y("",!0)}}},_t=$("transaction/index",{state:()=>({meta:{},transactionsLoading:!0,isEmptyData:!1,isLoadLock:!1,isAccessLazyLoad:!1}),getters:{currentNumberPage:t=>{var e;return((e=t.meta)==null?void 0:e.current_page)??1},nextNumberPage(){return this.currentNumberPage+1}},actions:{async firstLoadTransactions(t){const e=Object.assign({include:"category,account,currency,type,to_account,to_currency",page:1},t),a=await L(e);this.isAccessLazyLoad=F(a.data.data),w(this,a)},async lazyLoadTransactions(t={}){if(!this.isLoadLock){this.transactionsLoading=!0,this.isLoadLock=!0;try{const e=Object.assign({include:"category,account,currency,type,to_account,to_currency",page:this.nextNumberPage},t),a=await L(e);w(this,a)}finally{this.transactionsLoading=!1,this.isLoadLock=!1}}},reset(){this.isEmptyData=!1,this.isAccessLazyLoad=!1}}});async function L(t){return await k.query().setUpdateMode(G).setParams(t).get()}function w(t,e){t.meta=e.data.meta,t.isEmptyData=V(e.data.data)}function pt(t){return Object.values(t.reduce(rt,{}))}function rt(t,e){const a=e.transaction_at_date;return q(t[a])&&(t[a]={date:e.transaction_at_date,timestamp:e.transaction_at_timestamp,transactions:[]}),t[a].transactions.push(e),t}export{mt as _,ut as a,pt as t,_t as u};
