import{G as w,H as k,I as $,_ as q,m as A,r as m,o as r,c as S,a as b,t as C,k as d,w as p,e as I,J as M,K as R,f as E,j as L,s as O,d as g,F as V,y as P,L as j,E as D,N as T,b as U}from"./index-Be_DmAD-.js";import{c as N,i as B,d as z,C as y,e as G,v as H,A as J}from"./entities-COFJ0nU8.js";import{_ as K}from"./CurrenciesList-CtvG6uUc.js";const oe=w("accounts/index",{state:()=>({accountsPanelModel:[],categoriesIds:[]}),getters:{},actions:{addCategoryId(e){this.categoriesIds.indexOf(e)===-1&&this.categoriesIds.push(e)}}});function ue(e){return k(e)?!0:"Поле не може бути пустим."}function Z(e){return k(e)||e===0||e==="0"?!0:"Поле не може бути пустим."}function Q(e){return $(e)?!0:"Значення повинно бути цілим числом."}function re(e){const t=async()=>{const{valid:c}=await e.value.validate();return c},n=()=>e.value.resetValidation();return{validate:t,resetValidation:n,check:async()=>(n(),await t())}}const W={class:"d-flex align-center s-item"},X={class:"flex-grow-1"},Y={key:0,class:"align-self-center"},ee={__name:"AccountSumItem",props:{accountSum:{type:Object,required:!0,validator:e=>e instanceof N},isAvailableRemove:{type:Boolean,required:!1}},emits:{removeAccountSum:B},setup(e,{emit:t}){const n=e,o=t,c=A({get:()=>n.accountSum.balance??0,set:f=>z(n.accountSum,{balance:f})}),s=A(()=>y.find(n.accountSum.getRelation("currency"))),i=[Q,Z];return(f,u)=>{const l=m("v-text-field"),h=m("v-btn");return r(),S("div",W,[b("div",X,"Баланс ("+C(s.value.alphabetic_code)+")",1),b("div",null,[d(l,{modelValue:c.value,"onUpdate:modelValue":u[0]||(u[0]=_=>c.value=_),rules:i,density:"compact",width:"100",variant:"underlined",class:"s-text-field",type:"number"},{"append-inner":p(()=>[b("span",null,C(s.value.symbol),1)]),_:1},8,["modelValue"])]),e.isAvailableRemove?(r(),S("div",Y,[d(h,{variant:"text",icon:"mdi-close",onClick:u[1]||(u[1]=_=>o("removeAccountSum",e.accountSum))})])):I("",!0)])}}},te=q(ee,[["__scopeId","data-v-feb3efb9"]]),ne={__name:"TheAddAccountSum",emits:{selectedCurrency:G},setup(e,{emit:t}){const n=t,o=A(()=>y.all());return(c,s)=>{const i=m("v-divider"),f=m("v-btn"),u=m("v-menu");return r(),S("div",null,[d(i,{class:"mb-3"}),d(u,null,{activator:p(({props:l})=>[d(f,M(R(l)),{default:p(()=>[E(" Додати валюту ")]),_:2},1040)]),default:p(()=>[d(K,{currencies:o.value,onSelected:s[0]||(s[0]=l=>n("selectedCurrency",l))},null,8,["currencies"])]),_:1})])}}},ie={__name:"TheAccountSums",props:{accountSums:{type:Array,required:!0,validator:H},isCreateFirst:{type:Boolean,default:!1}},emits:{createdAccountSum:B},setup(e,{emit:t}){const n=e,o=t,c=L(!1),s=A(()=>y.findLoaded());O(()=>{i()});async function i(){s.value.length!==3&&await u(),n.isCreateFirst&&f()}function f(){const a=y.all();_(a[0])}async function u(){c.value=!0;try{await y.sync()}finally{c.value=!1}}function l(a){h(a)||_(a)}function h(a){return n.accountSums.some(v=>v.currency.id===a.id)}function _(a){const v=new N;v.balance=0,v.currency=a.id,o("createdAccountSum",v)}return(a,v)=>{const F=m("v-progress-linear");return r(),S(V,null,[c.value?(r(),g(F,{key:0,indeterminate:""})):I("",!0),(r(!0),S(V,null,P(e.accountSums,x=>(r(),g(te,{key:x.id,"account-sum":x},null,8,["account-sum"]))),128)),d(ne,{onSelectedCurrency:l})],64)}}},le=w("accounts/create",{state:()=>({account:null,sums:[]}),getters:{},actions:{createAccount(e){const t=new J;t.category=e,this.account=t},reset(){this.resetAccount(),this.resetAccountSum(),console.info("account and account sums were reset")},resetAccount(){this.account=null},resetAccountSum(){this.sums=[]},createAccountSum(e){this.sums.push(e)},deleteAccountSum(e){this.sums.splice(this.sums.indexOf(e),1)},async saveAccount(){this.account.currency=this.sums[0].currency.id;const e=await this.account.save({include:"sums,category"});await this.saveAccountSums(e)},async saveAccountSums(e){if(e)for(const t of this.sums)t.account=e,await t.save({include:"currency"})}}}),de={__name:"DialogComponent",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(e){const{mobile:t}=j(),n=D(e,"modelValue");return(o,c)=>{const s=m("v-dialog");return r(),g(s,{"max-width":"600",fullscreen:U(t),modelValue:n.value,"onUpdate:modelValue":c[0]||(c[0]=i=>n.value=i)},{default:p(()=>[T(o.$slots,"default")]),_:3},8,["fullscreen","modelValue"])}}};export{ie as _,le as a,re as b,de as c,ue as r,oe as u};
