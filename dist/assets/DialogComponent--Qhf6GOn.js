import{E as w,_ as $,m as A,r as m,o as r,c as S,a as b,t as C,k as d,w as p,e as k,G as q,H as M,f as R,j as D,s as E,d as g,F as V,y as O,I as P,D as j,J as L,b as T}from"./index-B9rgIAwP.js";import{b as I,c as U,d as B,e as F,C as y,f as z,_ as G,v as H,A as J}from"./CurrenciesList-vb3s7GVf.js";import{u as Z}from"./functions-DAvG65lt.js";const oe=w("accounts/index",{state:()=>({accountsPanelModel:[],categoriesIds:[]}),getters:{},actions:{addCategoryId(e){this.categoriesIds.indexOf(e)===-1&&this.categoriesIds.push(e)}}});function ue(e){return I(e)?!0:"Поле не може бути пустим."}function K(e){return I(e)||e===0||e==="0"?!0:"Поле не може бути пустим."}function Q(e){return U(e)?!0:"Значення повинно бути цілим числом."}function re(e){const t=async()=>{const{valid:c}=await e.value.validate();return c},n=()=>e.value.resetValidation();return{validate:t,resetValidation:n,check:async()=>(n(),await t())}}const W={class:"d-flex align-center s-item"},X={class:"flex-grow-1"},Y={key:0,class:"align-self-center"},ee={__name:"AccountSumItem",props:{accountSum:{type:Object,required:!0,validator:e=>e instanceof B},isAvailableRemove:{type:Boolean,required:!1}},emits:{removeAccountSum:F},setup(e,{emit:t}){const n=e,o=t,c=A({get:()=>n.accountSum.balance??0,set:f=>Z(n.accountSum,{balance:f})}),s=A(()=>y.find(n.accountSum.getRelation("currency"))),i=[Q,K];return(f,u)=>{const l=m("v-text-field"),h=m("v-btn");return r(),S("div",W,[b("div",X,"Баланс ("+C(s.value.alphabetic_code)+")",1),b("div",null,[d(l,{modelValue:c.value,"onUpdate:modelValue":u[0]||(u[0]=_=>c.value=_),rules:i,density:"compact",width:"100",variant:"underlined",class:"s-text-field",type:"number"},{"append-inner":p(()=>[b("span",null,C(s.value.symbol),1)]),_:1},8,["modelValue"])]),e.isAvailableRemove?(r(),S("div",Y,[d(h,{variant:"text",icon:"mdi-close",onClick:u[1]||(u[1]=_=>o("removeAccountSum",e.accountSum))})])):k("",!0)])}}},te=$(ee,[["__scopeId","data-v-feb3efb9"]]),ne={__name:"TheAddAccountSum",emits:{selectedCurrency:z},setup(e,{emit:t}){const n=t,o=A(()=>y.all());return(c,s)=>{const i=m("v-divider"),f=m("v-btn"),u=m("v-menu");return r(),S("div",null,[d(i,{class:"mb-3"}),d(u,null,{activator:p(({props:l})=>[d(f,q(M(l)),{default:p(()=>[R(" Додати валюту ")]),_:2},1040)]),default:p(()=>[d(G,{currencies:o.value,onSelected:s[0]||(s[0]=l=>n("selectedCurrency",l))},null,8,["currencies"])]),_:1})])}}},ie={__name:"TheAccountSums",props:{accountSums:{type:Array,required:!0,validator:H},isCreateFirst:{type:Boolean,default:!1}},emits:{createdAccountSum:F},setup(e,{emit:t}){const n=e,o=t,c=D(!1),s=A(()=>y.findLoaded());E(()=>{i()});async function i(){s.value.length!==3&&await u(),n.isCreateFirst&&f()}function f(){const a=y.all();_(a[0])}async function u(){c.value=!0;try{await y.sync()}finally{c.value=!1}}function l(a){h(a)||_(a)}function h(a){return n.accountSums.some(v=>v.currency.id===a.id)}function _(a){const v=new B;v.balance=0,v.currency=a.id,o("createdAccountSum",v)}return(a,v)=>{const N=m("v-progress-linear");return r(),S(V,null,[c.value?(r(),g(N,{key:0,indeterminate:""})):k("",!0),(r(!0),S(V,null,O(e.accountSums,x=>(r(),g(te,{key:x.id,"account-sum":x},null,8,["account-sum"]))),128)),d(ne,{onSelectedCurrency:l})],64)}}},le=w("accounts/create",{state:()=>({account:null,sums:[]}),getters:{},actions:{createAccount(e){const t=new J;t.category=e,this.account=t},reset(){this.resetAccount(),this.resetAccountSum(),console.info("account and account sums were reset")},resetAccount(){this.account=null},resetAccountSum(){this.sums=[]},createAccountSum(e){this.sums.push(e)},deleteAccountSum(e){this.sums.splice(this.sums.indexOf(e),1)},async saveAccount(){this.account.currency=this.sums[0].currency.id;const e=await this.account.save({include:"sums,category"});await this.saveAccountSums(e)},async saveAccountSums(e){if(e)for(const t of this.sums)t.account=e,await t.save({include:"currency"})}}}),de={__name:"DialogComponent",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(e){const{mobile:t}=P(),n=j(e,"modelValue");return(o,c)=>{const s=m("v-dialog");return r(),g(s,{"max-width":"600",fullscreen:T(t),modelValue:n.value,"onUpdate:modelValue":c[0]||(c[0]=i=>n.value=i)},{default:p(()=>[L(o.$slots,"default")]),_:3},8,["fullscreen","modelValue"])}}};export{ie as _,le as a,re as b,de as c,ue as r,oe as u};
