import{u as N,a as W,S as X}from"./form.store-BvAwOKPR.js";import{r as t,o as n,d as u,w as l,k as e,b as m,_ as Y,H as B,n as k,B as O,j as y,c as b,e as h,f as z,t as g,D as P,F as T,a as _,z as j,I as Z,i as H,x as ee,p as te,g as ne}from"./index-CatLxAw8.js";import{t as oe,c as ae,T as M,A as se}from"./entities-BmQlPgWX.js";import{u as ce}from"./currency_decimal_convert-KKbzYINo.js";import{u as le,t as re,_ as ue,a as ie}from"./collection_service-DGxYuxu2.js";import{r as _e,u as de,_ as me}from"./DialogComponent-D1PZ-0IT.js";import{a as pe,u as ve,_ as fe}from"./create.store-A2zF9yh-.js";import{_ as ye}from"./BottomConfirm-D17Vw_mt.js";import{_ as xe}from"./TheCategoryIcon-BNQk6OsT.js";import"./CurrenciesList-DnbHLS-5.js";const ge={__name:"TheAppBar",setup(f){const r=N();return(a,s)=>{const o=t("v-btn"),p=t("v-spacer"),d=t("v-app-bar");return n(),u(d,{elevation:2,density:"compact"},{prepend:l(()=>[e(o,{icon:"mdi-arrow-left",to:{name:"accounts.index"}})]),default:l(()=>[e(p),e(o,{icon:"mdi-pencil",onClick:s[0]||(s[0]=c=>m(r).editDialog=!0)})]),_:1})}}},he={class:"subheading font-weight-light text-grey text-center"},be={key:0},Se={class:"font-weight-bold text-center"},ke={class:"d-flex justify-space-between"},we={__name:"TheTitleSection",setup(f){const r=B(),a=N(),{toDecimal:s}=ce(),o=k(()=>a.getAccount),p=k(()=>o.value.sums.filter(C=>C.balance!==0)),d=k(()=>p.value.length),c=k(()=>!(d.value===1&&p.value[0].currency.id===1));O(E);const A=y(["січ","лют","бер","квіт","трав","черв","лип","сер"]),w=y([200,675,410,390,310,460,250,240]);async function E(){o.value.exists?a.accountId=r.params.id:await a.loadAccount(r.params.id)}return(C,$)=>{const V=t("v-progress-linear"),I=t("v-sparkline"),U=t("v-sheet"),L=t("v-card-title"),i=t("v-list-item"),v=t("v-list"),R=t("v-card-text"),D=t("v-card");return n(),b("div",null,[m(a).accountLoading?(n(),u(V,{key:0,indeterminate:""})):h("",!0),o.value?(n(),u(D,{key:1,class:"mt-8 mx-auto overflow-visible","max-width":"400",elevation:"0"},{default:l(()=>[e(U,{class:"v-sheet--offset mx-auto",color:"cyan",elevation:"12","max-width":"calc(100% - 32px)",rounded:"lg"},{default:l(()=>[e(I,{"auto-draw":"",labels:A.value,"model-value":w.value,color:"white","line-width":"2",padding:"16"},{label:l(x=>[z(g(x.value)+". ",1)]),_:1},8,["labels","model-value"])]),_:1}),e(L,{class:"text-center"},{default:l(()=>[z(g(o.value.name),1)]),_:1}),e(R,{class:"pt-0"},{default:l(()=>[o.value.place_type===m(P)?(n(),b(T,{key:0},[_("div",he,[z(" Поточний баланс"),d.value>1?(n(),b("span",be,", в "+g(d.value)+" валютах",1)):h("",!0)]),_("div",Se,g(m(oe)(m(s)(o.value.getSumInMineCurrency()))),1),c.value?(n(),u(v,{key:0},{default:l(()=>[(n(!0),b(T,null,j(p.value,x=>(n(),u(i,{key:x.id,"prepend-icon":"mdi-flag-outline",class:"s-list-item"},{title:l(()=>[_("div",ke,[_("div",null,g(x.currency.name),1),_("div",null,g(m(ae)(m(s)(x.balance),x.currency.alphabetic_code)),1)])]),_:2},1024))),128))]),_:1})):h("",!0)],64)):h("",!0)]),_:1})]),_:1})):h("",!0)])}}},Ce=Y(we,[["__scopeId","data-v-a2a449ae"]]),Te={__name:"TheTransactions",setup(f){const r=B(),a=le(),s=k(()=>a.isAccessLazyLoad&&!a.isEmptyData),o=k(()=>re(M.findLoaded())),p=y(!0),d={"filter[account_id_or_to_account_id]":r.params.id};O(c),Z(()=>{a.reset(),M.reset()});async function c(){a.reset();try{await a.firstLoadTransactions(d)}finally{p.value=!1}}const A=()=>{a.lazyLoadTransactions(d)};return(w,E)=>{const C=t("v-progress-linear"),$=t("v-card-text"),V=t("v-btn"),I=t("v-card-actions"),U=t("v-card"),L=t("v-fade-transition");return n(),u(L,{mode:"out-in"},{default:l(()=>[p.value?(n(),u(C,{key:0,indeterminate:""})):(n(),u(U,{key:1},{default:l(()=>[o.value.length?(n(),u($,{key:1},{default:l(()=>[(n(!0),b(T,null,j(o.value,i=>(n(),u(ie,{key:i.timestamp,group:i},null,8,["group"]))),128)),e(ue,{show:90,enable:s.value,onLoad:A},null,8,["enable"])]),_:1})):(n(),b(T,{key:0},[e($,null,{default:l(()=>[z(" Покищо транзакцій немає ")]),_:1}),e(I,null,{default:l(()=>[e(V,{"prepend-icon":"mdi-plus",text:"Додати транзакцію",to:{name:"transactions.create"}})]),_:1})],64))]),_:1}))]),_:1})}}},q=f=>(te("data-v-5904c9a0"),f=f(),ne(),f),Ae={class:"text-center mb-4"},$e={class:"s-card-text-block"},Ve=q(()=>_("div",null,"Категорія рахунку",-1)),Ie={class:"s-card-text-block"},Ue=q(()=>_("div",null,"Тип рахунку",-1)),Le={__name:"TheUpdateAccount",emits:["accountUpdate","dialogClose"],setup(f,{emit:r}){const a=r;pe();const s=B(),o=H();ve();const p=y(),d=y(!1);y();const c=y(se.find(s.params.id)),A=y(ee.find(i=>i.value===c.value.place_type).label),w=y(c.value.sums),{check:E}=de(p),C=[_e];O(()=>{});async function $(){await E()&&(a("accountUpdate"),await I(),await V())}async function V(){await c.value.save({include:"category,sums.currency"})}async function I(){for(const i of w.value)i.account=c.value.id,await i.save({include:"currency"})}function U(){a("dialogClose"),c.value.destroy(),o.push({name:"accounts.index"})}function L(i){w.value.push(i)}return(i,v)=>{const R=t("v-text-field"),D=t("v-divider"),x=t("v-form"),G=t("v-card-text"),F=t("v-btn"),J=t("v-spacer"),K=t("v-card-actions"),Q=t("v-card");return n(),u(Q,{"prepend-icon":"mdi-credit-card-edit-outline",title:"Редагування рахунку"},{default:l(()=>[c.value?(n(),u(G,{key:0},{default:l(()=>[_("div",Ae,[e(xe,{modelValue:c.value.icon,"onUpdate:modelValue":v[0]||(v[0]=S=>c.value.icon=S)},null,8,["modelValue"])]),e(x,{ref_key:"form",ref:p},{default:l(()=>[e(R,{label:"Назва рахунку",modelValue:c.value.name,"onUpdate:modelValue":v[1]||(v[1]=S=>c.value.name=S),rules:C},null,8,["modelValue"]),_("div",$e,[_("div",null,[Ve,_("div",null,g(c.value.category.name),1)]),e(D)]),_("div",Ie,[_("div",null,[Ue,_("div",null,g(A.value),1)]),e(D)]),c.value.place_type===m(P)?(n(),u(fe,{key:0,"account-sums":w.value,onCreatedAccountSum:L},null,8,["account-sums"])):h("",!0)]),_:1},512),e(ye,{modelValue:d.value,"onUpdate:modelValue":v[2]||(v[2]=S=>d.value=S),title:"Видалити?",onSuccess:U},null,8,["modelValue"])]),_:1})):h("",!0),e(D),e(K,null,{default:l(()=>[e(F,{class:"text-red",icon:"mdi-delete-outline",size:"large",variant:"plain",onClick:v[3]||(v[3]=S=>d.value=!0)}),e(J),e(F,{text:"Відміна",size:"large",variant:"plain",onClick:v[4]||(v[4]=S=>i.$emit("dialogClose"))}),e(F,{color:"primary",size:"large",text:"Зберегти",variant:"tonal",onClick:$})]),_:1})]),_:1})}}},De=Y(Le,[["__scopeId","data-v-5904c9a0"]]),Ee={__name:"TheEditAccount",setup(f){const r=N();return(a,s)=>(n(),u(me,{modelValue:m(r).editDialog,"onUpdate:modelValue":s[2]||(s[2]=o=>m(r).editDialog=o)},{default:l(()=>[e(De,{onAccountUpdate:s[0]||(s[0]=o=>m(r).editDialog=!1),onDialogClose:s[1]||(s[1]=o=>m(r).editDialog=!1)})]),_:1},8,["modelValue"]))}},ze={__name:"TheButtonAddTransaction",setup(f){const r=H(),a=B(),s=W(),o=()=>{s.accountId=parseInt(a.params.id,10),s.openStep=X,r.push({name:"transactions.create"})};return(p,d)=>{const c=t("v-fab");return n(),u(c,{icon:"mdi-plus",app:"",size:"x-large",onClick:o})}}},qe={__name:"Show",setup(f){const r=N(),a=k(()=>r.getAccount);return(s,o)=>(n(),b(T,null,[e(ge),e(Ce,{class:"mb-4"}),a.value.place_type===m(P)?(n(),b(T,{key:0},[e(Te),e(ze)],64)):h("",!0),e(Ee)],64))}};export{qe as default};
