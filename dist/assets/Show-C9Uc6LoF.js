import{u as B,a as W,S as X}from"./form.store-DSTuMn-H.js";import{r as n,o as a,d,w as u,j as e,b as i,m as x,c as C,a as r,f as I,t as g,e as T,F as V,x as F,_ as M,K as D,y as O,i as A,B as R,L as Z,h as Y,q as ee,T as te}from"./index-msQYrNo8.js";import{t as P,a as ne}from"./Model-52kJW6XD.js";import{u as oe}from"./currency_decimal_convert-KKbzYINo.js";import{c as ae,T as j,A as se}from"./entities-Be7q-u-Q.js";import{u as ce,t as le,_ as re,a as ue}from"./collection_service-17XeZPg9.js";import{_ as ie}from"./DialogComponent-BIhcZ3DL.js";import{r as de,u as _e}from"./form_validate-BmWDNyRb.js";import{a as me,u as ve,_ as pe}from"./create.store-CXDnxJOC.js";import{_ as fe}from"./BottomConfirm-aw5yHlbj.js";import{_ as ye}from"./TheCategoryIcon-7jqaFHVN.js";import"./CurrenciesList-CU0bJNLd.js";const xe={__name:"TheAppBar",setup(b){const s=B();return(o,t)=>{const l=n("v-btn"),p=n("v-spacer"),m=n("v-app-bar");return a(),d(m,{elevation:2,density:"compact"},{prepend:u(()=>[e(l,{icon:"mdi-arrow-left",to:{name:"accounts.index"}})]),default:u(()=>[e(p),e(l,{icon:"mdi-pencil",onClick:t[0]||(t[0]=c=>i(s).editDialog=!0)})]),_:1})}}},ge={class:"subheading font-weight-light text-grey text-center"},be={key:0},ke={class:"font-weight-bold text-center"},Ae={key:0,class:"d-flex justify-space-around"},Ce={class:"text-center"},Te={class:"text-center"},we={class:"d-flex justify-space-between"},Se={__name:"TheAccountInfoBalance",props:{account:{required:!0,type:Object,validator:ae}},setup(b){const s=b,{toDecimal:o}=oe(),t=x(()=>s.account.sums.filter(k=>k.balance!==0)),l=x(()=>t.value.length),p=x(()=>!(l.value===1&&t.value[0].currency.id===1)),m=x(()=>s.account.credit_limit>0),c=x(()=>s.account.getSumInMineCurrency()),$=x(()=>s.account.credit_limit+c.value);return(k,v)=>{const S=n("v-list-item"),w=n("v-list");return a(),C(V,null,[r("div",ge,[v[0]||(v[0]=I(" Поточний баланс")),l.value>1?(a(),C("span",be,", в "+g(l.value)+" валютах",1)):T("",!0)]),r("div",ke,g(i(P)(i(o)(c.value))),1),m.value?(a(),C("div",Ae,[r("div",Ce,[v[1]||(v[1]=r("div",null,"Доступно",-1)),r("div",null,g(i(P)(i(o)($.value))),1)]),r("div",Te,[v[2]||(v[2]=r("div",null,"Ліміт",-1)),r("div",null,g(i(P)(i(o)(b.account.credit_limit))),1)])])):T("",!0),p.value?(a(),d(w,{key:1},{default:u(()=>[(a(!0),C(V,null,F(t.value,y=>(a(),d(S,{key:y.id,"prepend-icon":"mdi-flag-outline",class:"s-list-item"},{title:u(()=>[r("div",we,[r("div",null,g(y.currency.name),1),r("div",null,g(i(ne)(i(o)(y.balance),y.currency.alphabetic_code)),1)])]),_:2},1024))),128))]),_:1})):T("",!0)],64)}}},he={__name:"TheAccountInfo",setup(b){const s=D(),o=B(),t=x(()=>o.getAccount);O(m);const l=A(["січ","лют","бер","квіт","трав","черв","лип","сер"]),p=A([200,675,410,390,310,460,250,240]);async function m(){t.value.exists?o.accountId=s.params.id:await o.loadAccount(s.params.id)}return(c,$)=>{const k=n("v-progress-linear"),v=n("v-sparkline"),S=n("v-sheet"),w=n("v-card-title"),y=n("v-card-text"),L=n("v-card");return a(),C("div",null,[i(o).accountLoading?(a(),d(k,{key:0,indeterminate:""})):T("",!0),t.value?(a(),d(L,{key:1,class:"mt-8 mx-auto overflow-visible","max-width":"400",elevation:"0"},{default:u(()=>[e(S,{class:"v-sheet--offset mx-auto",color:"cyan",elevation:"12","max-width":"calc(100% - 32px)",rounded:"lg"},{default:u(()=>[e(v,{"auto-draw":"",labels:l.value,"model-value":p.value,color:"white","line-width":"2",padding:"16"},{label:u(U=>[I(g(U.value)+". ",1)]),_:1},8,["labels","model-value"])]),_:1}),e(w,{class:"text-center"},{default:u(()=>[I(g(t.value.name),1)]),_:1}),e(y,{class:"pt-0"},{default:u(()=>[t.value.place_type===i(R)?(a(),d(Se,{key:0,account:t.value},null,8,["account"])):T("",!0)]),_:1})]),_:1})):T("",!0)])}}},$e=M(he,[["__scopeId","data-v-2b94f625"]]),Ve={__name:"TheTransactions",setup(b){const s=D(),o=ce(),t=x(()=>o.isAccessLazyLoad&&!o.isEmptyData),l=x(()=>le(j.findLoaded())),p=A(!0),m={"filter[account_id]":s.params.id};O(c),Z(()=>{o.reset(),j.reset()});async function c(){o.reset();try{await o.firstLoadTransactions(m)}finally{p.value=!1}}const $=()=>{o.lazyLoadTransactions(m)};return(k,v)=>{const S=n("v-progress-linear"),w=n("v-card-text"),y=n("v-btn"),L=n("v-card-actions"),U=n("v-card"),E=n("v-fade-transition");return a(),d(E,{mode:"out-in"},{default:u(()=>[p.value?(a(),d(S,{key:0,indeterminate:""})):(a(),d(U,{key:1},{default:u(()=>[l.value.length?(a(),d(w,{key:1},{default:u(()=>[(a(!0),C(V,null,F(l.value,f=>(a(),d(ue,{key:f.timestamp,group:f},null,8,["group"]))),128)),e(re,{show:90,enable:t.value,onLoad:$},null,8,["enable"])]),_:1})):(a(),C(V,{key:0},[e(w,null,{default:u(()=>v[0]||(v[0]=[I(" Покищо транзакцій немає ")])),_:1}),e(L,null,{default:u(()=>[e(y,{"prepend-icon":"mdi-plus",text:"Додати транзакцію",to:{name:"transactions.create"}})]),_:1})],64))]),_:1}))]),_:1})}}},Le={class:"text-center mb-4"},Ue={class:"s-card-text-block"},Ie={class:"s-card-text-block"},Be={__name:"TheUpdateAccount",emits:["accountUpdate","dialogClose"],setup(b,{emit:s}){const o=s;me();const t=D(),l=Y();ve();const p=A(),m=A(!1);A();const c=A(se.find(t.params.id)),$=A(ee.find(f=>f.value===c.value.place_type).label),k=A(c.value.sums),{check:v}=_e(p),S=[de];O(()=>{});async function w(){await v()&&(o("accountUpdate"),await L(),await y())}async function y(){await c.value.save({include:"category,sums.currency"})}async function L(){for(const f of k.value)f.account=c.value.id,await f.save({include:"currency"})}function U(){o("dialogClose"),c.value.destroy(),l.push({name:"accounts.index"})}function E(f){k.value.push(f)}return(f,_)=>{const q=n("v-text-field"),N=n("v-divider"),G=n("v-form"),H=n("v-card-text"),z=n("v-btn"),K=n("v-spacer"),J=n("v-card-actions"),Q=n("v-card");return a(),d(Q,{"prepend-icon":"mdi-credit-card-edit-outline",title:"Редагування рахунку"},{default:u(()=>[c.value?(a(),d(H,{key:0},{default:u(()=>[r("div",Le,[e(ye,{modelValue:c.value.icon,"onUpdate:modelValue":_[0]||(_[0]=h=>c.value.icon=h)},null,8,["modelValue"])]),e(G,{ref_key:"form",ref:p},{default:u(()=>[e(q,{label:"Назва рахунку",modelValue:c.value.name,"onUpdate:modelValue":_[1]||(_[1]=h=>c.value.name=h),rules:S},null,8,["modelValue"]),r("div",Ue,[r("div",null,[_[5]||(_[5]=r("div",null,"Категорія рахунку",-1)),r("div",null,g(c.value.category.name),1)]),e(N)]),r("div",Ie,[r("div",null,[_[6]||(_[6]=r("div",null,"Тип рахунку",-1)),r("div",null,g($.value),1)]),e(N)]),c.value.place_type===i(R)&&c.value.input_type===i(te)?(a(),d(pe,{key:0,"account-sums":k.value,onCreatedAccountSum:E},null,8,["account-sums"])):T("",!0)]),_:1},512),e(fe,{modelValue:m.value,"onUpdate:modelValue":_[2]||(_[2]=h=>m.value=h),title:"Видалити?",onSuccess:U},null,8,["modelValue"])]),_:1})):T("",!0),e(N),e(J,null,{default:u(()=>[e(z,{class:"text-red",icon:"mdi-delete-outline",size:"large",variant:"plain",onClick:_[3]||(_[3]=h=>m.value=!0)}),e(K),e(z,{text:"Відміна",size:"large",variant:"plain",onClick:_[4]||(_[4]=h=>f.$emit("dialogClose"))}),e(z,{color:"primary",size:"large",text:"Зберегти",variant:"tonal",onClick:w})]),_:1})]),_:1})}}},De=M(Be,[["__scopeId","data-v-99ca1c58"]]),Ee={__name:"TheEditAccount",setup(b){const s=B();return(o,t)=>(a(),d(ie,{modelValue:i(s).editDialog,"onUpdate:modelValue":t[2]||(t[2]=l=>i(s).editDialog=l)},{default:u(()=>[e(De,{onAccountUpdate:t[0]||(t[0]=l=>i(s).editDialog=!1),onDialogClose:t[1]||(t[1]=l=>i(s).editDialog=!1)})]),_:1},8,["modelValue"]))}},Ne={__name:"TheButtonAddTransaction",setup(b){const s=Y(),o=D(),t=W(),l=()=>{t.accountId=parseInt(o.params.id,10),t.openStep=X,s.push({name:"transactions.create"})};return(p,m)=>{const c=n("v-fab");return a(),d(c,{icon:"mdi-plus",app:"",size:"x-large",onClick:l})}}},Je={__name:"Show",setup(b){const s=B(),o=x(()=>s.getAccount);return(t,l)=>(a(),C(V,null,[e(xe),e($e,{class:"mb-4"}),o.value.place_type===i(R)?(a(),C(V,{key:0},[e(Ve),e(Ne)],64)):T("",!0),e(Ee)],64))}};export{Je as default};
