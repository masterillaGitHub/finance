import{t as ie,i as re,b as O,u as _e,a as A,c as de,S as pe,d as ve,e as me,s as fe,f as xe,g as ye,h as ge}from"./create.store-C0u5qHUL.js";import{r as t,o as l,d as y,w as o,k as e,_ as G,z as Z,c as _,a as S,t as w,b as s,e as N,P as ee,n as P,f as q,F as D,y as R,Q as he,s as Ce,j as T,R as te,S as ke,U as ne,p as Te,g as Se,V as Ve,W as $e,E as oe,X as be,T as z,i as we,Y as Ae}from"./index-CsBXRI5z.js";import{a as ae,_ as le}from"./CurrenciesList-Ct_5xQyC.js";import{u as se}from"./TheAccountStep.vue_vue_type_style_index_0_scoped_799e84e8_lang-BOd2Sfxn.js";import{e as F,A as J,a as X,T as Ie}from"./Transaction-CMZ7FxtM.js";/* empty css                                                         */import"./entities-n8vO3US1.js";function De(v,n){const a=ie(v);if(!re(a))throw new RangeError("Invalid time value");let c="";const u="-",r=":";{const i=O(a.getDate(),2),m=O(a.getMonth()+1,2);c=`${O(a.getFullYear(),4)}${u}${m}${u}${i}`}{const i=O(a.getHours(),2),m=O(a.getMinutes(),2),g=O(a.getSeconds(),2);c=`${c}${c===""?"":" "}${i}${r}${m}${r}${g}`}return c}const Ee={__name:"TheAppBar",setup(v){return _e(),(n,a)=>{const c=t("v-btn"),u=t("v-spacer"),r=t("v-app-bar");return l(),y(r,{elevation:2,density:"compact"},{prepend:o(()=>[e(c,{icon:"mdi-arrow-left",to:{name:"transactions.index"}})]),default:o(()=>[e(u)]),_:1})}}},Ue={class:"d-flex justify-end align-center pa-2"},Ne={class:"text-h3"},Me={__name:"TheCreateAmount",props:{amount:{type:[String,Number],default:"0"}},emits:["onClickOnAmount"],setup(v,{emit:n}){const a=n,c=A(),u=se();Z(r);async function r(){await u.loadCurrencies()}return(i,m)=>{const g=t("v-icon"),V=t("v-btn"),k=t("v-menu");return l(),_("div",Ue,[S("div",{class:"text-right mr-4 d-flex align-center",onClick:m[0]||(m[0]=f=>a("onClickOnAmount"))},[S("span",Ne,w(v.amount),1),s(c).isAmountValid?N("",!0):(l(),y(g,{key:0,color:"error",icon:"mdi-alert-circle"}))]),e(k,null,{activator:o(({props:f})=>[e(V,ee({variant:"outlined",class:"s-btn"},f,{"append-icon":"mdi-chevron-down",loading:s(u).loading}),{default:o(()=>[e(g,{icon:s(c).getCurrency.icon},null,8,["icon"])]),_:2},1040,["loading"])]),default:o(()=>[e(ae,{currencies:s(u).currencies,onSelected:m[1]||(m[1]=f=>s(c).currencyId=f.id)},null,8,["currencies"])]),_:1})])}}},Oe=G(Me,[["__scopeId","data-v-f878cf38"]]),Pe={key:"0",class:"text-grey"},Re={key:"1"},je={__name:"TheTypeStep",setup(v){const n=A(),a=P({get:()=>n.typeId,set:u=>n.typeId=u});async function c(){n.categoryId=null,n.accountTransferId=null,await Ce(),n.nextStep()}return(u,r)=>{const i=t("v-col"),m=t("v-fade-transition"),g=t("v-row"),V=t("v-expansion-panel-title"),k=t("v-chip"),f=t("v-chip-group"),b=t("v-expansion-panel-text"),x=t("v-expansion-panel");return l(),y(x,{value:s(de)},{default:o(()=>[e(V,{"hide-actions":""},{default:o(({expanded:h})=>[e(g,{"no-gutters":""},{default:o(()=>[e(i,{class:"d-flex justify-start",cols:"4"},{default:o(()=>[q("Тип:")]),_:1}),e(i,{class:"text--secondary text-right",cols:"8"},{default:o(()=>[e(m,{"leave-absolute":""},{default:o(()=>[h?(l(),_("span",Pe,"Вкажіть тип транзакції")):(l(),_("span",Re,w(s(n).getType.name),1))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:1}),e(b,null,{default:o(()=>[e(f,{mandatory:"",modelValue:a.value,"onUpdate:modelValue":r[0]||(r[0]=h=>a.value=h)},{default:o(()=>[(l(!0),_(D,null,R(s(he),h=>(l(),y(k,{key:h.id,label:"",variant:"text",text:h.name,value:h.id,onClick:c},null,8,["text","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["value"])}}},ce=v=>(Te("data-v-e43c452d"),v=v(),Se(),v),Ye={key:0},Be={key:1},Le={key:"0",class:"text-grey"},Fe={key:"1",class:"text-truncate"},ze={class:"ml-1"},Ge={key:1},qe={key:2},He={class:"s-parent-wrapper"},Qe=ce(()=>S("div",{class:"text-grey text-subtitle-2"},"Батьківська категорія",-1)),We=ce(()=>S("div",{class:"text-grey text-subtitle-2"},"Підкатегорії",-1)),Xe={__name:"TheCategoryStep",setup(v){const n=A(),a=T(!1),c=T(!1),u=T(),r=T(),i=T(new F),m=P(()=>F.findLoaded());te(g);async function g(){b(),c.value=!0;try{await F.sync({include:"children","filter[type_id]":n.typeId,"filter[user_id]":"auth"})}finally{c.value=!1}}function V(d){if(d.isChildren()){a.value=!0,i.value=d;return}x(d.id),h()}function k(d){x(d.id),h()}function f(){a.value=!1}function b(){x(),u.value=!1,r.value=!1,i.value=new F,a.value=!1}function x(d=null){n.categoryId=d}function h(){n.nextStep()}return(d,$)=>{const I=t("v-fade-transition"),E=t("v-col"),j=t("v-row"),Y=t("v-icon"),M=t("v-expansion-panel-title"),C=t("v-progress-linear"),B=t("v-badge"),L=t("v-chip"),U=t("v-chip-group"),H=t("v-btn"),Q=t("v-expansion-panel-text"),W=t("v-expansion-panel");return l(),y(W,{value:s(pe)},{default:o(()=>[e(M,null,{default:o(({expanded:p})=>[e(j,{"no-gutters":""},{default:o(()=>[e(E,{cols:"4"},{default:o(()=>[e(I,{"leave-absolute":""},{default:o(()=>[s(n).typeId===1?(l(),_("span",Ye,"На категорію:")):(l(),_("span",Be,"З категорії:"))]),_:1})]),_:1}),e(E,{class:"text--secondary text-right",cols:"8"},{default:o(()=>[e(I,{"leave-absolute":""},{default:o(()=>[p?(l(),_("div",Le,"Вкажіть категорію")):(l(),_("div",Fe,w(s(n).getCategory.name),1))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),actions:o(()=>[S("div",ze,[s(n).isCategoryValid?N("",!0):(l(),y(Y,{key:0,color:"error",icon:"mdi-alert-circle"}))])]),_:1}),e(Q,{class:"s-panel-text"},{default:o(()=>[e(I,{mode:"out-in"},{default:o(()=>[c.value?(l(),y(C,{key:0,indeterminate:""})):!a.value&&!c.value?(l(),_("div",Ge,[e(U,{mandatory:"",column:"",modelValue:u.value,"onUpdate:modelValue":$[0]||($[0]=p=>u.value=p)},{default:o(()=>[(l(!0),_(D,null,R(m.value,p=>(l(),y(L,{key:p.id,label:"",variant:"text",text:p.name,value:p.id,onClick:ue=>V(p)},ke({_:2},[p.isChildren()?{name:"append",fn:o(()=>[e(B,{content:p.childrenCount(),inline:"",color:"transparent"},null,8,["content"])]),key:"0"}:void 0]),1032,["text","value","onClick"]))),128))]),_:1},8,["modelValue"])])):(l(),_("div",qe,[S("div",He,[S("div",null,[Qe,e(U,{mandatory:"",column:"",modelValue:r.value,"onUpdate:modelValue":$[2]||($[2]=p=>r.value=p)},{default:o(()=>[e(L,{label:"",variant:"text",text:i.value.name,value:i.value.id,onClick:$[1]||($[1]=p=>k(i.value))},null,8,["text","value"])]),_:1},8,["modelValue"])]),e(H,{icon:"mdi-arrow-up-left",variant:"text",onClick:ne(f,["stop"])})]),We,e(U,{mandatory:"",column:"",modelValue:r.value,"onUpdate:modelValue":$[3]||($[3]=p=>r.value=p)},{default:o(()=>[(l(!0),_(D,null,R(i.value.children,p=>(l(),y(L,{key:p.id,label:"",variant:"text",text:p.name,value:p.id,onClick:ue=>k(p)},null,8,["text","value","onClick"]))),128))]),_:1},8,["modelValue"])]))]),_:1})]),_:1})]),_:1},8,["value"])}}},Ze=G(Xe,[["__scopeId","data-v-e43c452d"]]),Je={key:0,class:"text-grey"},Ke={key:1,class:"text-truncate"},et={key:2},tt={__name:"TheTagStep",emits:["done"],setup(v,{emit:n}){const a=T([]),c=P(()=>a.value.join(", ")),u=["Доходи","Витрати","Бюджет","Заощадження","Кредити","Депозити","Інвестиції","Податки","Зарплата","Пенсія","Страхування","Платежі","КомунальніПослуги","Продукти","Одяг","Транспорт","Розваги","Медицина","Освіта","Подарунки"];return(r,i)=>{const m=t("v-col"),g=t("v-fade-transition"),V=t("v-row"),k=t("v-expansion-panel-title"),f=t("v-chip"),b=t("v-chip-group"),x=t("v-expansion-panel-text"),h=t("v-expansion-panel");return l(),y(h,{value:s(ve)},{default:o(()=>[e(k,{"hide-actions":""},{default:o(()=>[e(V,{"no-gutters":""},{default:o(()=>[e(m,{class:"d-flex justify-start",cols:"4"},{default:o(()=>[q("Теги:")]),_:1}),e(m,{class:"text--secondary text-right",cols:"8"},{default:o(()=>[e(g,{"leave-absolute":""},{default:o(()=>[a.value.length===0?(l(),_("div",Je,"Вкажіть теги")):a.value.length<=3?(l(),_("div",Ke,w(c.value),1)):(l(),_("div",et,"вибрано "+w(a.value.length)+" тегів",1))]),_:1})]),_:1})]),_:1})]),_:1}),e(x,{class:"s-panel-text"},{default:o(()=>[e(b,{multiple:"",column:"",modelValue:a.value,"onUpdate:modelValue":i[0]||(i[0]=d=>a.value=d)},{default:o(()=>[(l(),_(D,null,R(u,(d,$)=>e(f,{key:$,label:"",variant:"text",text:d,value:d},null,8,["text","value"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["value"])}}},nt=G(tt,[["__scopeId","data-v-8d54d543"]]),ot={__name:"TheDateStep",emits:["done"],setup(v,{emit:n}){const a=A(),c=T(),u=T(!1),r=T(a.date),i=T();te(()=>{c.value=a.getDate,a.getDate==="today"?i.value="Сьогодні":a.getDate==="yesterday"?i.value="Вчора":a.getDate==="tomorrow"?i.value="Завтра":(c.value="custom",i.value=a.getDate)});function m(){a.date=fe(new Date,1),f()}function g(){a.date=new Date,f()}function V(){u.value=!0}function k(){a.date=r.value,u.value=!1,f()}function f(){a.nextStep()}return(b,x)=>{const h=t("v-col"),d=t("v-fade-transition"),$=t("v-row"),I=t("v-expansion-panel-title"),E=t("v-date-picker"),j=t("v-divider"),Y=t("v-spacer"),M=t("v-btn"),C=t("v-card-actions"),B=t("v-card"),L=t("v-dialog"),U=t("v-chip"),H=t("v-chip-group"),Q=t("v-expansion-panel-text"),W=t("v-expansion-panel");return l(),y(W,{value:s(me)},{default:o(()=>[e(I,{"hide-actions":""},{default:o(({expanded:p})=>[e($,{"no-gutters":""},{default:o(()=>[e(h,{class:"d-flex justify-start",cols:"4"},{default:o(()=>[q("Дата:")]),_:1}),e(h,{class:"text--secondary text-right",cols:"8"},{default:o(()=>[e(d,{"leave-absolute":""},{default:o(()=>[S("span",null,w(i.value),1)]),_:1})]),_:1})]),_:1})]),_:1}),e(Q,null,{default:o(()=>[e(L,{modelValue:u.value,"onUpdate:modelValue":x[2]||(x[2]=p=>u.value=p),"max-width":"600"},{default:o(()=>[e(B,null,{default:o(()=>[e(E,{modelValue:r.value,"onUpdate:modelValue":x[0]||(x[0]=p=>r.value=p),width:"100%",color:"primary"},null,8,["modelValue"]),e(j),e(C,null,{default:o(()=>[e(Y),e(M,{text:"Відміна",variant:"plain",onClick:x[1]||(x[1]=p=>u.value=!1)}),e(M,{color:"primary",text:"Вибрати",variant:"tonal",onClick:k})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(H,{mandatory:"",modelValue:c.value,"onUpdate:modelValue":x[3]||(x[3]=p=>c.value=p)},{default:o(()=>[e(U,{label:"",variant:"text",text:"Вчора",value:"yesterday",onClick:m}),e(U,{label:"",variant:"text",text:"Сьогодні",value:"today",onClick:g}),e(U,{label:"",variant:"text",text:"Вибрати",value:"custom",onClick:V})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["value"])}}},at={key:0},lt={key:1},st={key:"0",class:"text-grey"},ct={key:"1"},ut={class:"ml-1"},it={key:0},rt={key:1},_t={class:"s-back-button-wrapper"},dt={__name:"TheAccountStep",props:Ve({account:{type:Object,default:new J,validator:v=>v instanceof J},isValid:{type:Boolean,required:!0},isTransfer:{type:Boolean,default:!1},stepName:{type:String,default:xe}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(v){const n=v,a=A(),c=$e(v,"modelValue");P(()=>a.typeId),oe(()=>{n.isTransfer&&(c.value=null)});const u=T(!1),r=P(()=>X.findLoaded()),i=T(null),m=T(new X);function g(k){m.value=k,u.value=!0}function V(){u.value=!1}return(k,f)=>{const b=t("v-fade-transition"),x=t("v-col"),h=t("v-row"),d=t("v-icon"),$=t("v-expansion-panel-title"),I=t("v-chip"),E=t("v-chip-group"),j=t("v-btn"),Y=t("v-expansion-panel-text"),M=t("v-expansion-panel");return l(),y(M,{value:v.stepName},{default:o(()=>[e($,{"disable-icon-rotate":""},{default:o(({expanded:C})=>[e(h,{"no-gutters":""},{default:o(()=>[e(x,{cols:"4"},{default:o(()=>[e(b,{"leave-absolute":""},{default:o(()=>[s(a).typeId===s(be)||v.isTransfer?(l(),_("span",at,"На рахунок:")):(l(),_("span",lt,"З рахунку:"))]),_:1})]),_:1}),e(x,{class:"text--secondary text-right",cols:"8"},{default:o(()=>[e(b,{"leave-absolute":""},{default:o(()=>[C?(l(),_("div",st,"Вкажіть рахунок")):(l(),_("div",ct,w(v.account.name),1))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),actions:o(()=>[S("div",ut,[v.isValid?N("",!0):(l(),y(d,{key:0,color:"error",icon:"mdi-alert-circle"}))])]),_:1}),e(Y,{class:"s-panel-text"},{default:o(()=>[e(b,{mode:"out-in"},{default:o(()=>[u.value?(l(),_("div",rt,[S("div",_t,[e(j,{size:"small",text:"Назад",onClick:ne(V,["stop"])})]),e(E,{mandatory:"",column:"",modelValue:c.value,"onUpdate:modelValue":f[2]||(f[2]=C=>c.value=C)},{default:o(()=>[(l(!0),_(D,null,R(m.value.accounts,C=>(l(),y(I,{key:C.id,label:"",variant:"text",text:C.name,value:C.id,onClick:f[1]||(f[1]=B=>s(a).nextStep())},null,8,["text","value"]))),128))]),_:1},8,["modelValue"])])):(l(),_("div",it,[e(E,{mandatory:"",column:"",modelValue:i.value,"onUpdate:modelValue":f[0]||(f[0]=C=>i.value=C)},{default:o(()=>[(l(!0),_(D,null,R(r.value,C=>(l(),y(I,{key:C.id,label:"",variant:"text",text:C.name,value:C.id,onClick:B=>g(C)},null,8,["text","value","onClick"]))),128))]),_:1},8,["modelValue"])]))]),_:1})]),_:1})]),_:1},8,["value"])}}},K=G(dt,[["__scopeId","data-v-799e84e8"]]),pt={__name:"TheAccountsStepsChoice",setup(v){const n=A();return Z(async()=>{await X.loadTransactionPage()}),(a,c)=>(l(),_(D,null,[e(K,{modelValue:s(n).accountId,"onUpdate:modelValue":c[0]||(c[0]=u=>s(n).accountId=u),account:s(n).getAccount,"is-valid":s(n).isAccountValid},null,8,["modelValue","account","is-valid"]),s(n).typeId===s(z)?(l(),y(K,{key:0,modelValue:s(n).toAccountId,"onUpdate:modelValue":c[1]||(c[1]=u=>s(n).toAccountId=u),account:s(n).getToAccount,"is-valid":s(n).isToAccountValid,"is-transfer":!0,"step-name":s(ye)},null,8,["modelValue","account","is-valid","step-name"])):N("",!0)],64))}},vt={key:"0",class:"text-grey"},mt={key:"1"},ft={class:"d-flex justify-end align-center pa-2"},xt={class:"text-h5"},yt={__name:"TheToAmount",setup(v){const n=A(),a=se(),c=T(!1);return P({get:()=>n.toAmount,set:u=>n.toAmount=u}),Z(()=>{n.toAmount=n.amount,n.toCurrencyId=n.currencyId}),(u,r)=>{const i=t("v-col"),m=t("v-fade-transition"),g=t("v-row"),V=t("v-expansion-panel-title"),k=t("v-icon"),f=t("v-btn"),b=t("v-menu"),x=t("v-expansion-panel-text"),h=t("v-expansion-panel");return l(),y(h,{value:s(ge)},{default:o(()=>[e(V,{"hide-actions":""},{default:o(({expanded:d})=>[e(g,{"no-gutters":""},{default:o(()=>[e(i,{class:"d-flex justify-start",cols:"4"},{default:o(()=>[q("Переказати:")]),_:1}),e(i,{class:"text--secondary text-right",cols:"8"},{default:o(()=>[e(m,{"leave-absolute":""},{default:o(()=>[d?(l(),_("span",vt,"Вкажіть суму зарахування")):(l(),_("span",mt,w(s(n).toAmount)+" "+w(s(n).getToCurrency.symbol),1))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:1}),e(x,null,{default:o(()=>[S("div",ft,[S("div",{class:"text-right d-flex align-center",onClick:r[0]||(r[0]=d=>c.value=!0)},[S("span",xt,w(s(n).toAmount),1),s(n).isAmountValid?N("",!0):(l(),y(k,{key:0,color:"error",icon:"mdi-alert-circle"}))]),e(b,null,{activator:o(({props:d})=>[e(f,ee({variant:"flat",class:"s-btn"},d,{"append-icon":"mdi-chevron-down"}),{default:o(()=>[e(k,{icon:s(n).getToCurrency.icon},null,8,["icon"])]),_:2},1040)]),default:o(()=>[e(ae,{currencies:s(a).currencies,onSelected:r[1]||(r[1]=d=>s(n).toCurrencyId=d.id)},null,8,["currencies"])]),_:1})]),e(le,{modelValue:c.value,"onUpdate:modelValue":r[2]||(r[2]=d=>c.value=d),"start-sum":s(n).toAmount,onDone:r[3]||(r[3]=d=>s(n).toAmount=d)},null,8,["modelValue","start-sum"])]),_:1})]),_:1},8,["value"])}}},gt={__name:"TheTransactionSteps",setup(v){const n=A();return(a,c)=>{const u=t("v-expansion-panels");return l(),_("div",null,[e(u,{modelValue:s(n).openStep,"onUpdate:modelValue":c[0]||(c[0]=r=>s(n).openStep=r),variant:"accordion",elevation:"0"},{default:o(()=>[e(je),e(pt),s(n).typeId!==s(z)?(l(),y(Ze,{key:0})):N("",!0),s(n).typeId===s(z)?(l(),y(yt,{key:1})):N("",!0),e(nt),e(ot)]),_:1},8,["modelValue"])])}}},ht={__name:"TheSaveButton",setup(v){const n=A(),a=we(),c=T(!1);async function u(){if(n.isEnabledValidate=!0,!!n.isValid){c.value=!0;try{await r(),await a.push({name:"transactions.index"})}finally{c.value=!1}}}async function r(){const i=new Ie;i.currency=n.currencyId,i.type=n.typeId,i.account=n.accountId,i.category=n.categoryId,i.amount=n.amount,i.note=null,i.transaction_at=De(n.date),n.typeId===z&&(i.category=Ae,i.to_account=n.toAccountId,i.to_currency=n.toCurrencyId,i.to_amount=n.toAmount),await i.save()}return(i,m)=>{const g=t("v-btn");return l(),_("div",null,[e(g,{loading:c.value,color:"primary",rounded:"t-0 b-xl",size:"x-large",text:"Continue",variant:"flat",block:"",onClick:u},null,8,["loading"])])}}},Ct={class:"fill-height d-flex flex-column"},kt=S("div",{class:"flex-grow-1"},null,-1),It={__name:"Create",setup(v){const n=A(),a=T(!0);return oe(()=>{n.reset()}),(c,u)=>(l(),_(D,null,[e(Ee),S("div",Ct,[kt,e(Oe,{amount:s(n).amount,onOnClickOnAmount:u[0]||(u[0]=r=>a.value=!0)},null,8,["amount"]),e(le,{modelValue:a.value,"onUpdate:modelValue":u[1]||(u[1]=r=>a.value=r),"start-sum":s(n).amount,onDone:u[2]||(u[2]=r=>s(n).amount=r)},null,8,["modelValue","start-sum"]),e(gt),e(ht)])],64))}};export{It as default};
