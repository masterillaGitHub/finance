import{g as k,c as D,T as E}from"./entities-BLG8DoLQ.js";import{_ as N,n as m,T as z,r as y,o as r,c as _,a as s,k as c,w as C,t as u,y as L,e as g,i as P,E as A,F as I,z as O,l as S,d as j,N as B,q as $,J as F,O as V,M as q,C as G,P as M}from"./index-mw_ZxV5_.js";import{u as R}from"./currency_decimal_convert-KKbzYINo.js";const U={class:"d-flex justify-space-between"},H={class:"pa-2"},J={class:"d-flex flex-column flex-grow-1",style:{"min-width":"0"}},Y={class:"d-flex flex-wrap flex-grow-1"},Z={class:"s-text-truncate-wrapper mr-3"},K={class:"font-weight-bold text-truncate"},Q={class:"d-flex"},W={key:0},X={class:"text-green"},tt={class:"d-flex text-grey-darken-1"},et={class:"text-truncate"},at={key:0,class:"d-flex s-min-width-0 s-max-width-70"},st={class:"text-truncate"},nt={__name:"TransactionItem",props:{t:{type:Object,required:!0,validator:k}},setup(t){const e=t,a=R(),i=m(()=>l(a.toDecimal(e.t.amount),e.t.currency.alphabetic_code)),o=m(()=>l(a.toDecimal(e.t.to_amount),e.t.to_currency.alphabetic_code)),d=m(()=>e.t.amount>0),n=m(()=>e.t.type.id===z);function l(h,f){return D(h,f,{signDisplay:"exceptZero"}).replace("-","")}return(h,f)=>{var v,x;const p=y("v-icon"),b=y("v-avatar");return r(),_("div",U,[s("div",H,[c(b,{size:"small"},{default:C(()=>[c(p,{size:"large",icon:t.t.category.icon},null,8,["icon"])]),_:1})]),s("div",J,[s("div",Y,[s("div",Z,[s("div",K,u(t.t.category.name),1)]),s("div",Q,[s("div",{class:L({"text-green":d.value})},u(i.value),3),n.value&&t.t.currency.id!==t.t.to_currency.id?(r(),_("div",W,[c(p,{icon:"mdi-arrow-right-thin",class:"mx-1 text-grey-darken-1"}),s("span",X,u(o.value),1)])):g("",!0)])]),s("div",tt,[s("div",{class:L(["d-flex s-min-width-0",[n.value?"s-max-width-70":"w-100"]])},[c(p,{icon:t.t.account.icon,class:"mr-2"},null,8,["icon"]),s("span",et,u(t.t.account.name),1)],2),n.value?(r(),_("div",at,[c(p,{icon:"mdi-arrow-right-thin",class:"mx-1"}),c(p,{icon:(v=t.t.to_account)==null?void 0:v.icon,class:"mr-2"},null,8,["icon"]),s("span",st,u((x=t.t.to_account)==null?void 0:x.name),1)])):g("",!0)])])])}}},ot=N(nt,[["__scopeId","data-v-5f65a7ff"]]),ct={class:"s-group"},rt={class:"text-grey my-3"},_t={__name:"TransactionGroup",props:{group:Object},setup(t){const e=P(),a=i=>{e.push({name:"transactions.edit",params:{id:i.id}})};return(i,o)=>{const d=A("ripple");return r(),_("div",ct,[s("div",rt,u(t.group.date),1),(r(!0),_(I,null,O(t.group.transactions,n=>S((r(),j(ot,{class:"py-1",t:n,onClick:l=>a(n)},null,8,["t","onClick"])),[[d]])),256))])}}},it={key:0,class:"mt-8 h-3 text-center"},pt={__name:"TheBottomLazyLoading",props:{show:{type:Number,default:100},load:{type:Number,default:100},enable:{type:Boolean,default:!1}},emits:["load"],setup(t,{emit:e}){const a=t,i=e,o=B(),d=m(()=>o.offsetTopPercent>=a.show&&o.offsetTop>0),n=m(()=>d.value||o.offsetTop>0&&o.offsetTopPercent>=a.load);return $(n,l=>{l===!0&&a.enable&&i("load")}),(l,h)=>{const f=y("v-progress-circular");return d.value&&t.enable?(r(),_("div",it,[c(f,{indeterminate:""})])):g("",!0)}}},ft=F("transaction/index",{state:()=>({meta:{},transactionsLoading:!0,isEmptyData:!1,isLoadLock:!1,isAccessLazyLoad:!1}),getters:{currentNumberPage:t=>{var e;return((e=t.meta)==null?void 0:e.current_page)??1},nextNumberPage(){return this.currentNumberPage+1}},actions:{async firstLoadTransactions(t){const e=Object.assign({include:"category,account,currency,type,to_account,to_currency",page:1},t),a=await w(e);this.isAccessLazyLoad=V(a.data.data),T(this,a)},async lazyLoadTransactions(t={}){if(!this.isLoadLock){this.transactionsLoading=!0,this.isLoadLock=!0;try{const e=Object.assign({include:"category,account,currency,type,to_account,to_currency",page:this.nextNumberPage},t),a=await w(e);T(this,a)}finally{this.transactionsLoading=!1,this.isLoadLock=!1}}},reset(){this.isEmptyData=!1,this.isAccessLazyLoad=!1}}});async function w(t){return await E.query().setUpdateMode(q).setParams(t).get()}function T(t,e){t.meta=e.data.meta,t.isEmptyData=G(e.data.data)}function ht(t){return Object.values(t.reduce(dt,{}))}function dt(t,e){const a=e.transaction_at_date;return M(t[a])&&(t[a]={date:e.transaction_at_date,timestamp:e.transaction_at_timestamp,transactions:[]}),t[a].transactions.push(e),t}export{pt as _,_t as a,ht as t,ft as u};
