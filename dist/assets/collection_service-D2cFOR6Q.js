import{c as b,T as P}from"./Transaction-CMZ7FxtM.js";import{c as k}from"./entities-n8vO3US1.js";import{_ as E,n as _,T as N,r as f,o as d,c as p,a as s,k as r,w as D,t as m,x,e as y,i as A,B as z,F as I,y as O,l as S,d as j,J as B,q as C,G as $,K as G,L as U,A as V,N as q,O as F}from"./index-CsBXRI5z.js";const M={class:"d-flex justify-space-between"},R={class:"pa-2"},Y={class:"d-flex flex-column flex-grow-1",style:{"min-width":"0"}},H={class:"d-flex flex-wrap flex-grow-1"},J={class:"s-text-truncate-wrapper mr-3"},K={class:"font-weight-bold text-truncate"},Z={class:"d-flex"},Q={key:0},W={class:"text-green"},X={class:"d-flex text-grey-darken-1"},tt={class:"text-truncate"},et={key:0,class:"d-flex s-min-width-0 s-max-width-70"},st={class:"text-truncate"},at={__name:"TransactionItem",props:{t:{type:Object,required:!0,validator:k}},setup(t){const e=t,a=_(()=>c(e.t.amount,e.t.currency.alphabetic_code)),l=_(()=>c(e.t.to_amount,e.t.to_currency.alphabetic_code)),o=_(()=>e.t.amount>0),n=_(()=>e.t.type.id===N);function c(u,h){return b(u,h,{signDisplay:"exceptZero"}).replace("-","")}return(u,h)=>{var g,v;const i=f("v-icon"),w=f("v-avatar");return d(),p("div",M,[s("div",R,[r(w,{size:"small"},{default:D(()=>[r(i,{size:"large",icon:t.t.category.icon},null,8,["icon"])]),_:1})]),s("div",Y,[s("div",H,[s("div",J,[s("div",K,m(t.t.category.name),1)]),s("div",Z,[s("div",{class:x({"text-green":o.value})},m(a.value),3),n.value&&t.t.currency.id!==t.t.to_currency.id?(d(),p("div",Q,[r(i,{icon:"mdi-arrow-right-thin",class:"mx-1 text-grey-darken-1"}),s("span",W,m(l.value),1)])):y("",!0)])]),s("div",X,[s("div",{class:x(["d-flex s-min-width-0",[n.value?"s-max-width-70":"w-100"]])},[r(i,{icon:t.t.account.getIcon(),class:"mr-2"},null,8,["icon"]),s("span",tt,m(t.t.account.name),1)],2),n.value?(d(),p("div",et,[r(i,{icon:"mdi-arrow-right-thin",class:"mx-1"}),r(i,{icon:(g=t.t.to_account)==null?void 0:g.getIcon(),class:"mr-2"},null,8,["icon"]),s("span",st,m((v=t.t.to_account)==null?void 0:v.name),1)])):y("",!0)])])])}}},nt=E(at,[["__scopeId","data-v-2e8f3559"]]),ot={class:"s-group"},ct={class:"text-grey my-3"},mt={__name:"TransactionGroup",props:{group:Object},setup(t){const e=A(),a=l=>{e.push({name:"transactions.edit",params:{id:l.id}})};return(l,o)=>{const n=z("ripple");return d(),p("div",ot,[s("div",ct,m(t.group.date),1),(d(!0),p(I,null,O(t.group.transactions,c=>S((d(),j(nt,{class:"py-1",t:c,onClick:u=>a(c)},null,8,["t","onClick"])),[[n]])),256))])}}},it={key:0,class:"mt-8 h-3 text-center"},_t={__name:"TheBottomLazyLoading",props:{show:{type:Number,default:100},load:{type:Number,default:100},enable:{type:Boolean,default:!1}},emits:["load"],setup(t,{emit:e}){const a=t,l=e,o=B(),n=_(()=>o.offsetTopPercent>=a.show&&o.offsetTop>0),c=_(()=>n.value||o.offsetTop>0&&o.offsetTopPercent>=a.load);return C(c,u=>{u===!0&&a.enable&&l("load")}),(u,h)=>{const i=f("v-progress-circular");return n.value&&t.enable?(d(),p("div",it,[r(i,{indeterminate:""})])):y("",!0)}}},pt=$("transaction/index",{state:()=>({meta:{},transactionsLoading:!0,isEmptyData:!1,isLoadLock:!1,isAccessLazyLoad:!1,syncParams:{include:"category,account,currency,type,to_account,to_currency"}}),getters:{currentNumberPage:t=>{var e;return((e=t.meta)==null?void 0:e.current_page)??1},nextNumberPage(){return this.currentNumberPage+1}},actions:{addSyncParams(t){this.syncParams=Object.assign(this.syncParams,t)},async firstLoadTransactions(){const t=Object.assign(this.syncParams,{page:1}),e=await L(t,q);this.isAccessLazyLoad=G(e.data.data),T(this,e)},async lazyLoadTransactions(){if(!this.isLoadLock){this.transactionsLoading=!0,this.isLoadLock=!0;try{const t=Object.assign(this.syncParams,{page:this.nextNumberPage}),e=await L(t,U);T(this,e)}finally{this.transactionsLoading=!1,this.isLoadLock=!1}}},reset(){this.isEmptyData=!1,this.isAccessLazyLoad=!1}}});async function L(t,e){return await P.query().setUpdateMode(e).setParams(t).get()}function T(t,e){t.meta=e.data.meta,t.isEmptyData=V(e.data.data)}function ht(t){return Object.values(t.reduce(rt,{}))}function rt(t,e){const a=e.transaction_at_date;return F(t[a])&&(t[a]={date:e.transaction_at_date,timestamp:e.transaction_at_timestamp,transactions:[]}),t[a].transactions.push(e),t}export{_t as _,mt as a,ht as t,pt as u};
