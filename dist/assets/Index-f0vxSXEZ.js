import{l as Q,o as c,c as x,t as b,i as S,m as $,n as Z,p as tt,d as y,b as _,_ as V,r as o,w as i,j as e,f as et,a as d,e as N,A as M,q as O,s as nt,F as I,x as D,y as ot,z as at,k as q,v as st,B as it,C as ct,D as rt,M as ut,E as lt,G as dt,H as R,h as mt,I as P,J as _t}from"./index-ByPb97X1.js";import{u as B,a as j,_ as pt}from"./create.store-CIKNzY-P.js";import{u as U}from"./currency_decimal_convert-KKbzYINo.js";import{t as Y,u as vt}from"./Model-DON2mMJf.js";import{A as K,i as ft,a as k,b as ht}from"./entities-wQA0blo5.js";import{r as gt,u as At}from"./form_validate-IYaiQNKB.js";import{_ as yt}from"./TheCategoryIcon-aPVMBdQC.js";import{_ as xt}from"./DialogComponent-ax-Jd6Ik.js";import{B as Ct}from"./BankAccountResource-gK6DG6t9.js";import"./CurrenciesList-DHPGyVix.js";var z=Q({name:"Vue3Autocounter",interval:null,props:{startAmount:{type:Number,default:0},endAmount:{type:Number,default:0,required:!0},duration:{type:Number,default:3,validator(t){return t>0}},autoinit:{type:Boolean,default:!0},prefix:{type:String,default:""},suffix:{type:String,default:""},separator:{type:String,default:","},decimalSeparator:{type:String,default:"."},decimals:{type:Number,default:0,validator(t){return t>=0}}},data(){return{timestamp:0,startTimestamp:0,currentAmount:0,currentStartAmount:0,currentDuration:0,paused:!1,remaining:0,animationFrame:0}},mounted(){this.currentAmount=this.startAmount,this.currentStartAmount=this.startAmount,this.currentDuration=this.duration*1e3,this.remaining=this.duration*1e3,this.autoinit?this.start():this.paused=!0,this.$emit("mounted")},unmounted(){this.cancelAnimation()},watch:{startAmount(){this.reset()},endAmount(){this.reset()},duration(){this.reset()}},computed:{isCountingUp(){return this.endAmount>this.startAmount},displayedAmount(){return`${this.prefix}${this.formatedAmount}${this.suffix}`},formatedAmount(){const t=/(\d+)(\d{3})/;let a=this.currentAmount.toFixed(this.decimals);a+="";let s=a.split("."),n=s[0],l=s.length>1?this.decimalSeparator+s[1]:"",p=!isNaN(parseFloat(this.separator));if(this.separator&&!p)for(;t.test(n);)n=n.replace(t,"$1"+this.separator+"$2");return n+l}},methods:{start(){this.cancelAnimation(),this.currentStartAmount=this.startAmount,this.startTimestamp=null,this.currentDuration=this.duration*1e3,this.paused=!1,this.animationFrame=window.requestAnimationFrame(this.counting)},pause(){this.paused||(this.cancelAnimation(),this.paused=!0)},resume(){this.paused&&(this.startTimestamp=null,this.currentDuration=+this.remaining,this.currentStartAmount=+this.currentAmount,this.animationFrame=window.requestAnimationFrame(this.counting),this.paused=!1)},reset(){this.paused=!1,this.startTimestamp=null,this.cancelAnimation(),this.currentAmount=this.startAmount,this.autoinit?this.start():this.paused=!0},counting(t){this.timestamp=t,this.startTimestamp||(this.startTimestamp=t);let a=t-this.startTimestamp;this.remaining=this.currentDuration-a,this.isCountingUp?(this.currentAmount=this.currentStartAmount+(this.endAmount-this.currentStartAmount)*(a/this.currentDuration),this.currentAmount=this.currentAmount>this.endAmount?this.endAmount:this.currentAmount):(this.currentAmount=this.currentStartAmount-(this.currentStartAmount-this.endAmount)*(a/this.currentDuration),this.currentAmount=this.currentAmount<this.endAmount?this.endAmount:this.currentAmount),a<this.currentDuration?this.animationFrame=window.requestAnimationFrame(this.counting):this.$emit("finished")},cancelAnimation(){this.animationFrame&&window.cancelAnimationFrame(this.animationFrame)}}});function St(t,a,s,n,l,p){return c(),x("span",null,b(t.displayedAmount),1)}z.render=St;var bt=(()=>{const t=z;return t.install=a=>{a.component("Vue3Autocounter",t)},t})();const wt={__name:"AnimateCounter",props:{counter:{type:Number,required:!0},suffix:{type:String,default:""},prefix:{type:String,default:""},decimals:{type:Number,default:0}},emits:["finished"],setup(t,{emit:a}){const s=t,n=a,l=S(),p=S(s.counter),r=$(()=>s.counter);return Z(r,async(h,v)=>{p.value=v,await tt(),l.value.start()}),(h,v)=>(c(),y(_(bt),{ref_key:"counter",ref:l,startAmount:p.value,endAmount:r.value,duration:1,prefix:t.prefix,suffix:t.suffix,separator:" ",decimalSeparator:",",decimals:t.decimals,autoinit:!1,onFinished:v[0]||(v[0]=g=>n("finished"))},null,8,["startAmount","endAmount","prefix","suffix","decimals"]))}},Tt={class:"text-h6 font-weight-light"},$t={__name:"TheWealthChart",setup(t){const a=B(),{toDecimal:s}=U(),n=S(["січ","лют","бер","квіт","трав","черв","лип","сер"]),l=S([200,675,410,390,310,460,250,240]),p=S(!1),r=$(()=>s(a.amountTotal));return(h,v)=>{const g=o("v-sparkline"),u=o("v-sheet"),m=o("v-progress-circular"),A=o("v-fade-transition"),f=o("v-card-text"),w=o("v-card");return c(),y(w,{class:"mt-8 mx-auto overflow-visible","max-width":"400"},{default:i(()=>[e(u,{class:"v-sheet--offset mx-auto",color:"cyan",elevation:"12","max-width":"calc(100% - 32px)",rounded:"lg"},{default:i(()=>[e(g,{"auto-draw":"",labels:n.value,"model-value":l.value,color:"white","line-width":"2",padding:"16"},{label:i(C=>[et(b(C.value)+". ",1)]),_:1},8,["labels","model-value"])]),_:1}),e(f,{class:"pt-0"},{default:i(()=>[v[0]||(v[0]=d("div",{class:"subheading font-weight-light text-grey mb-2"}," Статок ",-1)),d("div",Tt,[e(wt,{counter:r.value,suffix:" ₴"},null,8,["counter"]),e(A,null,{default:i(()=>[p.value?(c(),y(m,{key:0,indeterminate:"",size:20,width:3,class:"ml-4"})):N("",!0)]),_:1})])]),_:1})]),_:1})}}},kt=V($t,[["__scopeId","data-v-4083970f"]]),It={class:"d-flex justify-space-between"},Nt={class:"text-truncate"},Vt={class:"ml-2"},Dt={key:0},Bt={key:1},Ut={__name:"AccountItem",props:{account:{type:Object,required:!0,validator:t=>t instanceof K}},setup(t){const a=t,{toDecimal:s}=U(),n=$(()=>Y(s(a.account.getSumInMineCurrency()),{maximumFractionDigits:0}));return(l,p)=>{const r=o("v-avatar"),h=o("v-list-item");return c(),y(h,{to:{name:"accounts.show",params:{id:t.account.id}},class:"s-list-item"},{prepend:i(()=>[e(r,{class:"s-handle-sorting-account-item",icon:t.account.icon,color:"green"},null,8,["icon"])]),title:i(()=>[d("div",It,[d("div",Nt,b(t.account.name),1),d("div",Vt,[t.account.place_type===_(M)?(c(),x("span",Dt,b(_(O)[1].label),1)):(c(),x("span",Bt,b(n.value),1))])])]),_:1},8,["to"])}}},Ft=V(Ut,[["__scopeId","data-v-84fa44fe"]]),Lt={class:"d-flex w-100 justify-space-between align-center"},Et={class:"s-handle-sorting-account-group"},Pt={key:"0"},Mt={key:"1"},Ot={__name:"AccountCategoryItem",props:{category:{type:Object,required:!0,validator:ft}},setup(t){const a=t,{toDecimal:s}=U(),n=$(()=>Y(s(a.category.getSumInMineCurrency()),{maximumFractionDigits:0}));return(l,p)=>{const r=o("v-icon"),h=o("v-expansion-panel-title"),v=o("v-list"),g=o("v-expansion-panel-text"),u=o("v-expansion-panel");return c(),y(u,null,{default:i(()=>[e(h,{"hide-actions":"",class:"s-panel-title"},{default:i(({expanded:m})=>[d("div",Lt,[d("div",Et,[m?(c(),x("span",Pt,[e(r,{icon:"mdi-menu-down"})])):(c(),x("span",Mt,[e(r,{icon:"mdi-menu-right"})])),d("span",null,b(t.category.name),1)]),d("div",{class:nt({"text-grey":m})},[d("span",null,b(n.value),1)],2)])]),_:1}),e(g,{class:"s-custom-expansion-panel-text"},{default:i(()=>[e(v,null,{default:i(()=>[(c(!0),x(I,null,D(t.category.accounts,m=>(c(),y(Ft,{key:m.id,account:m},null,8,["account"]))),128))]),_:1})]),_:1})]),_:1})}}},qt=V(Ot,[["__scopeId","data-v-505d6249"]]),Rt={style:{height:"4px"}},jt={key:0},Yt={__name:"TheAccounts",setup(t){const a=B();S([]);const s=$(()=>k.findIn(a.categoriesIds)),n=S(!1);ot(async()=>{await l()});async function l(){n.value=!0;try{const r=await k.loadMainPage();at(r.data.data)&&p(),a.categoriesIds=[...r.data.data],a.updateAmountTotal()}finally{n.value=!1}}function p(){k.reset(),K.reset(),ht.reset()}return(r,h)=>{const v=o("v-progress-linear"),g=o("v-fade-transition"),u=o("v-expansion-panels");return c(),x("div",null,[d("div",Rt,[e(g,null,{default:i(()=>[q(e(v,{indeterminate:""},null,512),[[st,n.value]])]),_:1})]),e(g,{mode:"out-in"},{default:i(()=>[s.value.length?(c(),x("div",jt,[e(u,{multiple:"",modelValue:_(a).accountsPanelModel,"onUpdate:modelValue":h[0]||(h[0]=m=>_(a).accountsPanelModel=m)},{default:i(()=>[(c(!0),x(I,null,D(s.value,m=>(c(),y(qt,{key:m.id,category:m},null,8,["category"]))),128))]),_:1},8,["modelValue"])])):N("",!0)]),_:1})])}}},Kt={class:"text-center mb-4"},zt={class:"s-card-text-block"},Gt={class:"s-card-text-block"},Ht={__name:"TheCreateAccount",emits:["accountSave","dialogClose"],setup(t,{emit:a}){const s=a;vt();const n=j(),l=B(),p=S(),{check:r}=At(p),h=[gt];async function v(){await r()&&(s("accountSave"),g(),await n.saveAccount())}function g(){const A=n.account.getRelation("category");l.addCategoryId(A)}function u(A){n.createAccountSum(A)}function m(A){A===M&&n.resetAccountSum()}return(A,f)=>{const w=o("v-text-field"),C=o("v-divider"),L=o("v-select"),G=o("v-form"),H=o("v-card-text"),W=o("v-spacer"),E=o("v-btn"),J=o("v-card-actions"),X=o("v-card");return c(),y(X,{"prepend-icon":"mdi-credit-card-plus-outline",title:"Додати рахунок"},{default:i(()=>[e(H,null,{default:i(()=>[d("div",Kt,[e(yt,{modelValue:_(n).account.icon,"onUpdate:modelValue":f[0]||(f[0]=T=>_(n).account.icon=T)},null,8,["modelValue"])]),_(n).account?(c(),y(G,{key:0,ref_key:"form",ref:p},{default:i(()=>[e(w,{autofocus:"",label:"Назва рахунку",modelValue:_(n).account.name,"onUpdate:modelValue":f[1]||(f[1]=T=>_(n).account.name=T),rules:h},null,8,["modelValue"]),d("div",zt,[d("div",null,[f[4]||(f[4]=d("div",null,"Категорія рахунку",-1)),d("div",null,b(_(n).account.category.name),1)]),e(C)]),d("div",Gt,[d("div",null,[f[5]||(f[5]=d("div",null,"Тип рахунку",-1)),d("div",null,[e(L,{modelValue:_(n).account.place_type,"onUpdate:modelValue":[f[2]||(f[2]=T=>_(n).account.place_type=T),m],"item-value":"value","item-title":"label",items:_(O),variant:"underlined"},null,8,["modelValue","items"])])]),e(C)]),_(n).account.place_type===_(it)?(c(),y(pt,{key:0,"account-sums":_(n).sums,"is-create-first":!0,onCreatedAccountSum:u},null,8,["account-sums"])):N("",!0)]),_:1},512)):N("",!0)]),_:1}),e(C),e(J,null,{default:i(()=>[e(W),e(E,{text:"Відміна",variant:"plain",onClick:f[3]||(f[3]=T=>A.$emit("dialogClose"))}),e(E,{color:"primary",text:"Зберегти",variant:"tonal",onClick:v})]),_:1})]),_:1})}}},Wt=V(Ht,[["__scopeId","data-v-b8db70bc"]]),F=ct("accounts/add",{state:()=>({categoryLoading:!1,categoriesIds:[],isShowAccountList:!1,isShowChoiceBankType:!1}),getters:{getCategories:t=>k.findIn(t.categoriesIds)},actions:{async categorySync(){if(!rt(this.getCategories)){this.categoryLoading=!0;try{const t=await k.query().setUpdateMode(ut).get();this.categoriesIds=t.data.data}finally{this.categoryLoading=!1}}}}}),Jt={class:"d-flex flex-column align-center justify-center fill-height"},Xt={class:"text-center"},Qt={__name:"TheAccountCategoryList",emits:{selectedCategoryId:Number},setup(t,{emit:a}){const s=a,n=F();S([]);const l=$(()=>n.getCategories);return(p,r)=>{const h=o("v-icon"),v=o("v-sheet"),g=o("v-col"),u=o("v-row"),m=o("v-container"),A=o("v-card"),f=o("v-bottom-sheet"),w=lt("ripple");return c(),y(f,{modelValue:_(n).isShowAccountList,"onUpdate:modelValue":r[0]||(r[0]=C=>_(n).isShowAccountList=C)},{default:i(()=>[e(A,null,{default:i(()=>[e(m,null,{default:i(()=>[e(u,null,{default:i(()=>[(c(!0),x(I,null,D(l.value,C=>(c(),y(g,{cols:"6"},{default:i(()=>[q((c(),y(v,{border:"",rounded:"lg",height:"100",class:"w-100 bg-grey-lighten-3",onClick:L=>s("selectedCategoryId",C.id)},{default:i(()=>[d("div",Jt,[e(h,{class:"mb-1",icon:C.icon},null,8,["icon"]),d("div",Xt,b(C.name),1)])]),_:2},1032,["onClick"])),[[w]])]),_:2},1024))),256))]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}},Zt={__name:"TheChoiceBankType",emits:{selectedBankTypeId:Number},setup(t,{emit:a}){const s=F(),n=a,l=[{id:dt,title:"Синхронізація із банком",icon:"mdi-sync",description:"Підключіть свій банк щоб отримувати транзакції автоматично"},{id:R,title:"Ручний ввід",icon:"mdi-gesture-tap",description:"Додавайте транзакції вручну"}];return(p,r)=>{const h=o("v-list-item"),v=o("v-list"),g=o("v-bottom-sheet");return c(),y(g,{modelValue:_(s).isShowChoiceBankType,"onUpdate:modelValue":r[0]||(r[0]=u=>_(s).isShowChoiceBankType=u)},{default:i(()=>[e(v,{lines:"three"},{default:i(()=>[(c(),x(I,null,D(l,u=>e(h,{key:u.id,"prepend-icon":u.icon,title:u.title,subtitle:u.description,onClick:m=>n("selectedBankTypeId",u.id)},null,8,["prepend-icon","title","subtitle","onClick"])),64))]),_:1})]),_:1},8,["modelValue"])}}},te={class:"text-center"},ee={__name:"TheAddAccount",setup(t){const a=j(),s=F(),n=mt(),l=S(!1),p=async()=>{await s.categorySync(),s.isShowAccountList=!0};function r(u){a.resetAccountSum(),a.createAccount(u),l.value=!0}function h(u){u===P?s.isShowChoiceBankType=!0:r(u)}function v(u){u===R?r(P):n.push({name:"banks.index"})}function g(){s.isShowAccountList=!1,l.value=!1}return(u,m)=>{const A=o("v-icon"),f=o("v-btn");return c(),x(I,null,[d("div",te,[e(f,{variant:"outlined",loading:_(s).categoryLoading,onClick:p},{default:i(()=>[e(A,{icon:"mdi-wallet-plus-outline"})]),_:1},8,["loading"])]),e(Qt,{onSelectedCategoryId:h}),e(Zt,{onSelectedBankTypeId:v}),e(xt,{modelValue:l.value,"onUpdate:modelValue":m[1]||(m[1]=w=>l.value=w)},{default:i(()=>[e(Wt,{onAccountSave:g,onDialogClose:m[0]||(m[0]=w=>l.value=!1)})]),_:1},8,["modelValue"])],64)}}},ne={class:"pa-2"},_e={__name:"Index",setup(t){const a=S(!1),s=async()=>{a.value=!0;try{await Ct.updateTransactions(_t)}finally{a.value=!1}};return(n,l)=>{const p=o("v-icon"),r=o("v-btn");return c(),x("div",ne,[e(kt,{class:"mb-4"}),e(Yt,{class:"mb-5"}),e(ee),e(r,{variant:"outlined",loading:a.value,onClick:s},{default:i(()=>[e(p,{icon:"mdi-sync"})]),_:1},8,["loading"])])}}};export{_e as default};
