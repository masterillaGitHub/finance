import{n as N,r as t,o as s,d as T,w as n,k as e,f as B,c as p,t as A,b as u,F as P,z as j,U as pe,s as oe,_ as q,j as I,V as ae,W as ve,e as M,a as b,X as me,Y as le,p as fe,g as xe,Z as ye,$ as ge,I as Ce,S as se,B as Q,T as z,J as he,C as K,a0 as ce,i as Te,a1 as ke,q as Se,Q as Ve}from"./index-BzizgZbg.js";import{t as $e,i as Ie,c as Y,a as D,d as be,S as we,e as Ae,f as De,s as Ee,b as Ue,g as Ne,h as Pe}from"./form.store-Cz_gLrPN.js";import{h as G,A as ee,a as J,C as te}from"./entities-Ld4GelJy.js";import{a as ue,_ as ie}from"./CurrenciesList-BZ_0te8g.js";import{u as re}from"./currency_decimal_convert-KKbzYINo.js";function Me(v,o){const a=$e(v);if(!Ie(a))throw new RangeError("Invalid time value");let i="";const l="-",d=":";{const c=Y(a.getDate(),2),_=Y(a.getMonth()+1,2);i=`${Y(a.getFullYear(),4)}${l}${_}${l}${c}`}{const c=Y(a.getHours(),2),_=Y(a.getMinutes(),2),y=Y(a.getSeconds(),2);i=`${i}${i===""?"":" "}${c}${d}${_}${d}${y}`}return i}const Oe={key:"0",class:"text-grey"},Re={key:"1"},Ye={__name:"TheTypeStep",setup(v){const o=D(),a=N({get:()=>o.typeId,set:l=>o.typeId=l});async function i(){o.categoryId=null,o.accountTransferId=null,await oe(),o.nextStep()}return(l,d)=>{const c=t("v-col"),_=t("v-fade-transition"),y=t("v-row"),$=t("v-expansion-panel-title"),k=t("v-chip"),r=t("v-chip-group"),C=t("v-expansion-panel-text"),m=t("v-expansion-panel");return s(),T(m,{value:u(be)},{default:n(()=>[e($,{"hide-actions":""},{default:n(({expanded:x})=>[e(y,{"no-gutters":""},{default:n(()=>[e(c,{class:"d-flex justify-start",cols:"4"},{default:n(()=>[B("Тип:")]),_:1}),e(c,{class:"text--secondary text-right",cols:"8"},{default:n(()=>[e(_,{"leave-absolute":""},{default:n(()=>[x?(s(),p("span",Oe,"Вкажіть тип транзакції")):(s(),p("span",Re,A(u(o).getType.name),1))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:1}),e(C,null,{default:n(()=>[e(r,{mandatory:"",modelValue:a.value,"onUpdate:modelValue":d[0]||(d[0]=x=>a.value=x)},{default:n(()=>[(s(!0),p(P,null,j(u(pe),x=>(s(),T(k,{key:x.id,label:"",variant:"text",text:x.name,value:x.id,onClick:i},null,8,["text","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["value"])}}},W=v=>(fe("data-v-f3ca537d"),v=v(),xe(),v),je={key:0},Be={key:1},Le={key:0,class:"text-truncate"},Fe=W(()=>b("div",{class:"text-grey"},"Вкажіть категорію",-1)),ze={class:"ml-1"},Ge={key:1},qe={key:2},Xe={class:"s-parent-wrapper"},Ze=W(()=>b("div",{class:"text-grey text-subtitle-2"},"Батьківська категорія",-1)),He=W(()=>b("div",{class:"text-grey text-subtitle-2"},"Підкатегорії",-1)),Je={__name:"TheCategoryStep",setup(v){const o=D(),a=I(!1),i=I(!1),l=I(),d=I(),c=I(new G),_=N(()=>G.findLoaded().filter(g=>!!g.user_id));ae(y);async function y(){C(),i.value=!0;try{await oe(),await G.loadCategoryStep(o.typeId)}finally{i.value=!1}}function $(g){if(g.isChildren()){a.value=!0,c.value=g;return}m(g.id),x()}function k(g){m(g.id),x()}function r(){a.value=!1}function C(){ve(o.transactionId)&&m(),l.value=!1,d.value=!1,c.value=new G,a.value=!1}function m(g=null){o.categoryId=g}function x(){o.nextStep()}return(g,S)=>{const w=t("v-fade-transition"),E=t("v-col"),U=t("v-icon"),O=t("v-row"),V=t("v-expansion-panel-title"),h=t("v-progress-linear"),L=t("v-badge"),F=t("v-chip"),R=t("v-chip-group"),X=t("v-btn"),Z=t("v-expansion-panel-text"),H=t("v-expansion-panel");return s(),T(H,{value:u(we)},{default:n(()=>[e(V,null,{default:n(({expanded:f})=>[e(O,{"no-gutters":""},{default:n(()=>[e(E,{cols:"4"},{default:n(()=>[e(w,{"leave-absolute":""},{default:n(()=>[u(o).typeId===1?(s(),p("span",je,"На категорію:")):(s(),p("span",Be,"З категорії:"))]),_:1})]),_:1}),e(E,{class:"text--secondary text-right",cols:"8"},{default:n(()=>[e(w,{"leave-absolute":""},{default:n(()=>[u(o).getCategory.id?(s(),p("div",Le,[e(U,{icon:u(o).getCategory.icon},null,8,["icon"]),B(" "+A(u(o).getCategory.name),1)])):M("",!0),Fe]),_:1})]),_:1})]),_:1})]),actions:n(()=>[b("div",ze,[u(o).isCategoryValid?M("",!0):(s(),T(U,{key:0,color:"error",icon:"mdi-alert-circle"}))])]),_:1}),e(Z,{class:"s-panel-text"},{default:n(()=>[e(w,{mode:"out-in"},{default:n(()=>[i.value?(s(),T(h,{key:0,indeterminate:""})):!a.value&&!i.value?(s(),p("div",Ge,[b("button",{onClick:y},"Push"),e(R,{mandatory:"",column:"",modelValue:l.value,"onUpdate:modelValue":S[0]||(S[0]=f=>l.value=f)},{default:n(()=>[(s(!0),p(P,null,j(_.value,f=>(s(),T(F,{key:f.id,label:"",variant:"text","prepend-icon":f.icon,text:f.name,value:f.id,onClick:_e=>$(f)},me({_:2},[f.isChildren()?{name:"append",fn:n(()=>[e(L,{content:f.childrenCount(),inline:"",color:"transparent"},null,8,["content"])]),key:"0"}:void 0]),1032,["prepend-icon","text","value","onClick"]))),128))]),_:1},8,["modelValue"])])):(s(),p("div",qe,[b("div",Xe,[b("div",null,[Ze,e(R,{mandatory:"",column:"",modelValue:d.value,"onUpdate:modelValue":S[2]||(S[2]=f=>d.value=f)},{default:n(()=>[e(F,{label:"",variant:"text",text:c.value.name,value:c.value.id,onClick:S[1]||(S[1]=f=>k(c.value))},null,8,["text","value"])]),_:1},8,["modelValue"])]),e(X,{icon:"mdi-arrow-up-left",variant:"text",onClick:le(r,["stop"])})]),He,e(R,{mandatory:"",column:"",modelValue:d.value,"onUpdate:modelValue":S[3]||(S[3]=f=>d.value=f)},{default:n(()=>[(s(!0),p(P,null,j(c.value.children,f=>(s(),T(F,{key:f.id,label:"",variant:"text",text:f.name,value:f.id,onClick:_e=>k(f)},null,8,["text","value","onClick"]))),128))]),_:1},8,["modelValue"])]))]),_:1})]),_:1})]),_:1},8,["value"])}}},Qe=q(Je,[["__scopeId","data-v-f3ca537d"]]),We={key:0,class:"text-grey"},Ke={key:1,class:"text-truncate"},et={key:2},tt={__name:"TheTagStep",emits:["done"],setup(v,{emit:o}){const a=I([]),i=N(()=>a.value.join(", ")),l=["Доходи","Витрати","Бюджет","Заощадження","Кредити","Депозити","Інвестиції","Податки","Зарплата","Пенсія","Страхування","Платежі","КомунальніПослуги","Продукти","Одяг","Транспорт","Розваги","Медицина","Освіта","Подарунки"];return(d,c)=>{const _=t("v-col"),y=t("v-fade-transition"),$=t("v-row"),k=t("v-expansion-panel-title"),r=t("v-chip"),C=t("v-chip-group"),m=t("v-expansion-panel-text"),x=t("v-expansion-panel");return s(),T(x,{value:u(Ae)},{default:n(()=>[e(k,{"hide-actions":""},{default:n(()=>[e($,{"no-gutters":""},{default:n(()=>[e(_,{class:"d-flex justify-start",cols:"4"},{default:n(()=>[B("Теги:")]),_:1}),e(_,{class:"text--secondary text-right",cols:"8"},{default:n(()=>[e(y,{"leave-absolute":""},{default:n(()=>[a.value.length===0?(s(),p("div",We,"Вкажіть теги")):a.value.length<=3?(s(),p("div",Ke,A(i.value),1)):(s(),p("div",et,"вибрано "+A(a.value.length)+" тегів",1))]),_:1})]),_:1})]),_:1})]),_:1}),e(m,{class:"s-panel-text"},{default:n(()=>[e(C,{multiple:"",column:"",modelValue:a.value,"onUpdate:modelValue":c[0]||(c[0]=g=>a.value=g)},{default:n(()=>[(s(),p(P,null,j(l,(g,S)=>e(r,{key:S,label:"",variant:"text",text:g,value:g},null,8,["text","value"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["value"])}}},nt=q(tt,[["__scopeId","data-v-8d54d543"]]),ot={__name:"TheDateStep",emits:["done"],setup(v,{emit:o}){const a=D(),i=I(),l=I(!1),d=I(a.date),c=I();ae(()=>{i.value=a.getDate,a.getDate==="today"?c.value="Сьогодні":a.getDate==="yesterday"?c.value="Вчора":a.getDate==="tomorrow"?c.value="Завтра":(i.value="custom",c.value=a.getDate)});function _(){a.date=Ee(new Date,1),r()}function y(){a.date=new Date,r()}function $(){l.value=!0}function k(){a.date=d.value,l.value=!1,r()}function r(){a.nextStep()}return(C,m)=>{const x=t("v-col"),g=t("v-fade-transition"),S=t("v-row"),w=t("v-expansion-panel-title"),E=t("v-date-picker"),U=t("v-divider"),O=t("v-spacer"),V=t("v-btn"),h=t("v-card-actions"),L=t("v-card"),F=t("v-dialog"),R=t("v-chip"),X=t("v-chip-group"),Z=t("v-expansion-panel-text"),H=t("v-expansion-panel");return s(),T(H,{value:u(De)},{default:n(()=>[e(w,{"hide-actions":""},{default:n(({expanded:f})=>[e(S,{"no-gutters":""},{default:n(()=>[e(x,{class:"d-flex justify-start",cols:"4"},{default:n(()=>[B("Дата:")]),_:1}),e(x,{class:"text--secondary text-right",cols:"8"},{default:n(()=>[e(g,{"leave-absolute":""},{default:n(()=>[b("span",null,A(c.value),1)]),_:1})]),_:1})]),_:1})]),_:1}),e(Z,null,{default:n(()=>[e(F,{modelValue:l.value,"onUpdate:modelValue":m[2]||(m[2]=f=>l.value=f),"max-width":"600"},{default:n(()=>[e(L,null,{default:n(()=>[e(E,{modelValue:d.value,"onUpdate:modelValue":m[0]||(m[0]=f=>d.value=f),width:"100%",color:"primary"},null,8,["modelValue"]),e(U),e(h,null,{default:n(()=>[e(O),e(V,{text:"Відміна",variant:"plain",onClick:m[1]||(m[1]=f=>l.value=!1)}),e(V,{color:"primary",text:"Вибрати",variant:"tonal",onClick:k})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(X,{mandatory:"",modelValue:i.value,"onUpdate:modelValue":m[3]||(m[3]=f=>i.value=f)},{default:n(()=>[e(R,{label:"",variant:"text",text:"Вчора",value:"yesterday",onClick:_}),e(R,{label:"",variant:"text",text:"Сьогодні",value:"today",onClick:y}),e(R,{label:"",variant:"text",text:"Вибрати",value:"custom",onClick:$})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["value"])}}},at={key:0},lt={key:1},st={key:0,class:"text-truncate"},ct={key:1,class:"text-grey"},ut={class:"ml-1"},it={key:0},rt={key:1},dt={class:"s-back-button-wrapper"},_t={__name:"TheAccountStep",props:ye({account:{type:Object,default:new ee,validator:v=>v instanceof ee},isValid:{type:Boolean,required:!0},isTransfer:{type:Boolean,default:!1},stepName:{type:String,default:Ue}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(v){const o=v,a=D(),i=ge(v,"modelValue");N(()=>a.typeId),Ce(()=>{o.isTransfer&&(i.value=null)});const l=I(!1),d=N(()=>J.findLoaded()),c=I(null),_=I(new J);function y(k){_.value=k,l.value=!0}function $(){l.value=!1}return(k,r)=>{const C=t("v-fade-transition"),m=t("v-col"),x=t("v-icon"),g=t("v-row"),S=t("v-expansion-panel-title"),w=t("v-chip"),E=t("v-chip-group"),U=t("v-btn"),O=t("v-expansion-panel-text"),V=t("v-expansion-panel");return s(),T(V,{value:v.stepName},{default:n(()=>[e(S,{"disable-icon-rotate":""},{default:n(({expanded:h})=>[e(g,{"no-gutters":""},{default:n(()=>[e(m,{cols:"4"},{default:n(()=>[e(C,{"leave-absolute":""},{default:n(()=>[u(a).typeId===u(se)||v.isTransfer?(s(),p("span",at,"На рахунок:")):(s(),p("span",lt,"З рахунку:"))]),_:1})]),_:1}),e(m,{class:"text--secondary text-right",cols:"8"},{default:n(()=>[e(C,{"leave-absolute":""},{default:n(()=>[v.account.id?(s(),p("div",st,[e(x,{icon:v.account.icon},null,8,["icon"]),B(" "+A(v.account.name),1)])):(s(),p("div",ct,"Вкажіть рахунок"))]),_:1})]),_:1})]),_:1})]),actions:n(()=>[b("div",ut,[v.isValid?M("",!0):(s(),T(x,{key:0,color:"error",icon:"mdi-alert-circle"}))])]),_:1}),e(O,{class:"s-panel-text"},{default:n(()=>[e(C,{mode:"out-in"},{default:n(()=>[l.value?(s(),p("div",rt,[b("div",dt,[e(U,{size:"small",text:"Назад",onClick:le($,["stop"])})]),e(E,{mandatory:"",column:"",modelValue:i.value,"onUpdate:modelValue":r[2]||(r[2]=h=>i.value=h)},{default:n(()=>[(s(!0),p(P,null,j(_.value.accounts,h=>(s(),T(w,{key:h.id,label:"",variant:"text","prepend-icon":h.icon,text:h.name,value:h.id,onClick:r[1]||(r[1]=L=>u(a).nextStep())},null,8,["prepend-icon","text","value"]))),128))]),_:1},8,["modelValue"])])):(s(),p("div",it,[e(E,{mandatory:"",column:"",modelValue:c.value,"onUpdate:modelValue":r[0]||(r[0]=h=>c.value=h)},{default:n(()=>[(s(!0),p(P,null,j(d.value,h=>(s(),T(w,{key:h.id,label:"","prepend-icon":h.icon,variant:"text",text:h.name,value:h.id,onClick:L=>y(h)},null,8,["prepend-icon","text","value","onClick"]))),128))]),_:1},8,["modelValue"])]))]),_:1})]),_:1})]),_:1},8,["value"])}}},ne=q(_t,[["__scopeId","data-v-8e72374d"]]),pt={__name:"TheAccountsStepsChoice",setup(v){const o=D();return Q(async()=>{await J.loadTransactionPage()}),(a,i)=>(s(),p(P,null,[e(ne,{modelValue:u(o).accountId,"onUpdate:modelValue":i[0]||(i[0]=l=>u(o).accountId=l),account:u(o).getAccount,"is-valid":u(o).isAccountValid},null,8,["modelValue","account","is-valid"]),u(o).typeId===u(z)?(s(),T(ne,{key:0,modelValue:u(o).toAccountId,"onUpdate:modelValue":i[1]||(i[1]=l=>u(o).toAccountId=l),account:u(o).getToAccount,"is-valid":u(o).isToAccountValid,"is-transfer":!0,"step-name":u(Ne)},null,8,["modelValue","account","is-valid","step-name"])):M("",!0)],64))}},de=he("currencies",{state:()=>({loading:!1}),getters:{currencies:()=>te.findLoaded()},actions:{async loadCurrencies(){if(this.currencies.length!==3){this.loading=!0;try{await te.sync()}finally{this.loading=!1}}}}}),vt={key:"0",class:"text-grey"},mt={key:"1"},ft={class:"d-flex justify-end align-center pa-2"},xt={class:"text-h5"},yt={__name:"TheToAmount",setup(v){const{toDecimal:o,toPlus:a,toInteger:i}=re(),l=D(),d=de(),c=I(!1),_=N(()=>o(l.toAmount));Q(()=>{y(),$()});function y(){K(l.toAmount)&&(l.toAmount=a(l.amount))}function $(){K(l.toCurrencyId)&&(l.toCurrencyId=l.currencyId)}return(k,r)=>{const C=t("v-col"),m=t("v-fade-transition"),x=t("v-row"),g=t("v-expansion-panel-title"),S=t("v-icon"),w=t("v-btn"),E=t("v-menu"),U=t("v-expansion-panel-text"),O=t("v-expansion-panel");return s(),T(O,{value:u(Pe)},{default:n(()=>[e(g,{"hide-actions":""},{default:n(({expanded:V})=>[e(x,{"no-gutters":""},{default:n(()=>[e(C,{class:"d-flex justify-start",cols:"4"},{default:n(()=>[B("Переказати:")]),_:1}),e(C,{class:"text--secondary text-right",cols:"8"},{default:n(()=>[e(m,{"leave-absolute":""},{default:n(()=>[V?(s(),p("span",vt,"Вкажіть суму зарахування")):(s(),p("span",mt,A(_.value)+" "+A(u(l).getToCurrency.symbol),1))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:1}),e(U,null,{default:n(()=>[b("div",ft,[b("div",{class:"text-right d-flex align-center",onClick:r[0]||(r[0]=V=>c.value=!0)},[b("span",xt,A(_.value),1),u(l).isAmountValid?M("",!0):(s(),T(S,{key:0,color:"error",icon:"mdi-alert-circle"}))]),e(E,null,{activator:n(({props:V})=>[e(w,ce({variant:"flat",class:"s-btn"},V,{"append-icon":"mdi-chevron-down"}),{default:n(()=>[e(S,{icon:u(l).getToCurrency.icon},null,8,["icon"])]),_:2},1040)]),default:n(()=>[e(ue,{currencies:u(d).currencies,onSelected:r[1]||(r[1]=V=>u(l).toCurrencyId=V.id)},null,8,["currencies"])]),_:1})]),e(ie,{modelValue:c.value,"onUpdate:modelValue":r[2]||(r[2]=V=>c.value=V),"start-sum":_.value,onDone:r[3]||(r[3]=V=>u(l).toAmount=u(i)(V))},null,8,["modelValue","start-sum"])]),_:1})]),_:1},8,["value"])}}},bt={__name:"TheTransactionSteps",setup(v){const o=D();return(a,i)=>{const l=t("v-expansion-panels");return s(),p("div",null,[e(l,{modelValue:u(o).openStep,"onUpdate:modelValue":i[0]||(i[0]=d=>u(o).openStep=d),variant:"accordion",elevation:"0"},{default:n(()=>[e(Ye),e(pt),u(o).typeId!==u(z)?(s(),T(Qe,{key:0})):M("",!0),u(o).typeId===u(z)?(s(),T(yt,{key:1})):M("",!0),e(nt),e(ot)]),_:1},8,["modelValue"])])}}},wt={__name:"TheSaveButton",setup(v){const o=D(),a=Te(),i=I(!1);async function l(){if(o.isEnabledValidate=!0,!!o.isValid){i.value=!0;try{await d(),await a.push({name:"transactions.index"})}finally{i.value=!1}}}async function d(){const c=o.getTransaction;c.currency=o.currencyId,c.type=o.typeId,c.account=o.accountId,c.category=o.categoryId,c.amount=o.amount,c.note=null,c.transaction_at=Me(o.date),o.typeId===z&&(c.category=ke,c.to_account=o.toAccountId,c.to_currency=o.toCurrencyId,c.to_amount=o.toAmount),await c.save()}return(c,_)=>{const y=t("v-btn");return s(),p("div",null,[e(y,{loading:i.value,color:"primary",rounded:"t-0 b-xl",size:"x-large",text:"Continue",variant:"flat",block:"",onClick:l},null,8,["loading"])])}}},gt={class:"d-flex justify-end align-center pa-2"},Ct={class:"text-h3"},ht={__name:"TheCreateAmount",props:{amount:{type:[String,Number],default:"0"}},emits:["onClickOnAmount"],setup(v,{emit:o}){const a=o,i=D(),l=de();Q(d);async function d(){await l.loadCurrencies()}return(c,_)=>{const y=t("v-icon"),$=t("v-btn"),k=t("v-menu");return s(),p("div",gt,[b("div",{class:"text-right mr-4 d-flex align-center",onClick:_[0]||(_[0]=r=>a("onClickOnAmount"))},[b("span",Ct,A(v.amount),1),u(i).isAmountValid?M("",!0):(s(),T(y,{key:0,color:"error",icon:"mdi-alert-circle"}))]),e(k,null,{activator:n(({props:r})=>[e($,ce({variant:"outlined",class:"s-btn"},r,{"append-icon":"mdi-chevron-down",loading:u(l).loading}),{default:n(()=>[e(y,{icon:u(i).getCurrency.icon},null,8,["icon"])]),_:2},1040,["loading"])]),default:n(()=>[e(ue,{currencies:u(l).currencies,onSelected:_[1]||(_[1]=r=>u(i).currencyId=r.id)},null,8,["currencies"])]),_:1})])}}},Tt=q(ht,[["__scopeId","data-v-2875c90d"]]),At={__name:"TheAmount",props:{isCalcShow:{type:Boolean,default:!1}},setup(v){const o=v,a=D(),{toInteger:i,toMinus:l,toPlus:d,toDecimal:c}=re(),_=I(o.isCalcShow),y=N(()=>d(c(a.amount))),$=N(()=>a.typeId);Se($,()=>{a.amount=k(a.amount)});const k=C=>{switch(a.typeId){case Ve:case z:return l(C);case se:return d(C)}},r=C=>{a.amount=k(i(C))};return(C,m)=>(s(),p(P,null,[e(Tt,{amount:y.value,onOnClickOnAmount:m[0]||(m[0]=x=>_.value=!0)},null,8,["amount"]),e(ie,{modelValue:_.value,"onUpdate:modelValue":m[1]||(m[1]=x=>_.value=x),"start-sum":y.value,onDone:m[2]||(m[2]=x=>r(x))},null,8,["modelValue","start-sum"])],64))}};export{At as _,bt as a,wt as b};
