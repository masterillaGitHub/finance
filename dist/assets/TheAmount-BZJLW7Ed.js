import{n as P,r as t,o as l,d as k,w as n,k as e,f as B,c as d,t as A,b as u,F as M,y as Y,Q as _e,s as pe,_ as q,j as I,R as ne,S as ve,e as U,a as b,U as me,V as oe,p as fe,g as xe,W as ye,X as ge,E as Ce,O as ae,z as W,T as G,G as he,A as J,Y as le,i as ke,Z as Te,q as Se,P as Ve}from"./index-uNLpc8m8.js";import{t as $e,i as Ie,c as j,a as D,d as be,S as we,e as Ae,f as De,s as Ee,g as Ue,h as Ne,j as Pe}from"./form.store-BS9jCDq-.js";import{h as z,A as K,a as Q,C as ee}from"./entities-DXs83vKd.js";import{a as se,_ as ce}from"./CurrenciesList-FRp3ZG6X.js";import{u as ue}from"./currency_decimal_convert-KKbzYINo.js";function Me(m,o){const a=$e(m);if(!Ie(a))throw new RangeError("Invalid time value");let i="";const s="-",_=":";{const c=j(a.getDate(),2),p=j(a.getMonth()+1,2);i=`${j(a.getFullYear(),4)}${s}${p}${s}${c}`}{const c=j(a.getHours(),2),p=j(a.getMinutes(),2),y=j(a.getSeconds(),2);i=`${i}${i===""?"":" "}${c}${_}${p}${_}${y}`}return i}const Oe={key:"0",class:"text-grey"},Re={key:"1"},je={__name:"TheTypeStep",setup(m){const o=D(),a=P({get:()=>o.typeId,set:s=>o.typeId=s});async function i(){o.categoryId=null,o.accountTransferId=null,await pe(),o.nextStep()}return(s,_)=>{const c=t("v-col"),p=t("v-fade-transition"),y=t("v-row"),$=t("v-expansion-panel-title"),T=t("v-chip"),r=t("v-chip-group"),h=t("v-expansion-panel-text"),f=t("v-expansion-panel");return l(),k(f,{value:u(be)},{default:n(()=>[e($,{"hide-actions":""},{default:n(({expanded:x})=>[e(y,{"no-gutters":""},{default:n(()=>[e(c,{class:"d-flex justify-start",cols:"4"},{default:n(()=>[B("Тип:")]),_:1}),e(c,{class:"text--secondary text-right",cols:"8"},{default:n(()=>[e(p,{"leave-absolute":""},{default:n(()=>[x?(l(),d("span",Oe,"Вкажіть тип транзакції")):(l(),d("span",Re,A(u(o).getType.name),1))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:1}),e(h,null,{default:n(()=>[e(r,{mandatory:"",modelValue:a.value,"onUpdate:modelValue":_[0]||(_[0]=x=>a.value=x)},{default:n(()=>[(l(!0),d(M,null,Y(u(_e),x=>(l(),k(T,{key:x.id,label:"",variant:"text",text:x.name,value:x.id,onClick:i},null,8,["text","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["value"])}}},ie=m=>(fe("data-v-d9fbc6ef"),m=m(),xe(),m),Ye={key:0},Be={key:1},Le={key:"0",class:"text-grey"},Fe={key:"1"},Ge={key:0,class:"text-truncate"},ze={class:"ml-1"},qe={key:1},Xe={key:2},Ze={class:"s-parent-wrapper"},He=ie(()=>b("div",{class:"text-grey text-subtitle-2"},"Батьківська категорія",-1)),Qe=ie(()=>b("div",{class:"text-grey text-subtitle-2"},"Підкатегорії",-1)),We={__name:"TheCategoryStep",setup(m){const o=D(),a=I(!1),i=I(!1),s=I(),_=I(),c=I(new z),p=P(()=>z.findLoaded().filter(g=>!!g.user_id));ne(y);async function y(){h(),i.value=!0;try{await z.loadCategoryStep(o.typeId)}finally{i.value=!1}}function $(g){if(g.isChildren()){a.value=!0,c.value=g;return}f(g.id),x()}function T(g){f(g.id),x()}function r(){a.value=!1}function h(){ve(o.transactionId)&&f(),s.value=!1,_.value=!1,c.value=new z,a.value=!1}function f(g=null){o.categoryId=g}function x(){o.nextStep()}return(g,S)=>{const w=t("v-fade-transition"),E=t("v-col"),N=t("v-icon"),O=t("v-row"),V=t("v-expansion-panel-title"),C=t("v-progress-linear"),L=t("v-badge"),F=t("v-chip"),R=t("v-chip-group"),X=t("v-btn"),Z=t("v-expansion-panel-text"),H=t("v-expansion-panel");return l(),k(H,{value:u(we)},{default:n(()=>[e(V,null,{default:n(({expanded:v})=>[e(O,{"no-gutters":""},{default:n(()=>[e(E,{cols:"4"},{default:n(()=>[e(w,{"leave-absolute":""},{default:n(()=>[u(o).typeId===1?(l(),d("span",Ye,"На категорію:")):(l(),d("span",Be,"З категорії:"))]),_:1})]),_:1}),e(E,{class:"text--secondary text-right",cols:"8"},{default:n(()=>[e(w,{"leave-absolute":""},{default:n(()=>[v?(l(),d("div",Le,"Вкажіть категорію")):(l(),d("div",Fe,[u(o).getCategory.id?(l(),d("span",Ge,[e(N,{icon:u(o).getCategory.icon},null,8,["icon"]),B(" "+A(u(o).getCategory.name),1)])):U("",!0)]))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),actions:n(()=>[b("div",ze,[u(o).isCategoryValid?U("",!0):(l(),k(N,{key:0,color:"error",icon:"mdi-alert-circle"}))])]),_:1}),e(Z,{class:"s-panel-text"},{default:n(()=>[e(w,{mode:"out-in"},{default:n(()=>[i.value?(l(),k(C,{key:0,indeterminate:""})):!a.value&&!i.value?(l(),d("div",qe,[e(R,{mandatory:"",column:"",modelValue:s.value,"onUpdate:modelValue":S[0]||(S[0]=v=>s.value=v)},{default:n(()=>[(l(!0),d(M,null,Y(p.value,v=>(l(),k(F,{key:v.id,label:"",variant:"text","prepend-icon":v.icon,text:v.name,value:v.id,onClick:de=>$(v)},me({_:2},[v.isChildren()?{name:"append",fn:n(()=>[e(L,{content:v.childrenCount(),inline:"",color:"transparent"},null,8,["content"])]),key:"0"}:void 0]),1032,["prepend-icon","text","value","onClick"]))),128))]),_:1},8,["modelValue"])])):(l(),d("div",Xe,[b("div",Ze,[b("div",null,[He,e(R,{mandatory:"",column:"",modelValue:_.value,"onUpdate:modelValue":S[2]||(S[2]=v=>_.value=v)},{default:n(()=>[e(F,{label:"",variant:"text",text:c.value.name,value:c.value.id,onClick:S[1]||(S[1]=v=>T(c.value))},null,8,["text","value"])]),_:1},8,["modelValue"])]),e(X,{icon:"mdi-arrow-up-left",variant:"text",onClick:oe(r,["stop"])})]),Qe,e(R,{mandatory:"",column:"",modelValue:_.value,"onUpdate:modelValue":S[3]||(S[3]=v=>_.value=v)},{default:n(()=>[(l(!0),d(M,null,Y(c.value.children,v=>(l(),k(F,{key:v.id,label:"",variant:"text",text:v.name,value:v.id,onClick:de=>T(v)},null,8,["text","value","onClick"]))),128))]),_:1},8,["modelValue"])]))]),_:1})]),_:1})]),_:1},8,["value"])}}},Je=q(We,[["__scopeId","data-v-d9fbc6ef"]]),Ke={key:0,class:"text-grey"},et={key:1,class:"text-truncate"},tt={key:2},nt={__name:"TheTagStep",emits:["done"],setup(m,{emit:o}){const a=I([]),i=P(()=>a.value.join(", ")),s=["Доходи","Витрати","Бюджет","Заощадження","Кредити","Депозити","Інвестиції","Податки","Зарплата","Пенсія","Страхування","Платежі","КомунальніПослуги","Продукти","Одяг","Транспорт","Розваги","Медицина","Освіта","Подарунки"];return(_,c)=>{const p=t("v-col"),y=t("v-fade-transition"),$=t("v-row"),T=t("v-expansion-panel-title"),r=t("v-chip"),h=t("v-chip-group"),f=t("v-expansion-panel-text"),x=t("v-expansion-panel");return l(),k(x,{value:u(Ae)},{default:n(()=>[e(T,{"hide-actions":""},{default:n(()=>[e($,{"no-gutters":""},{default:n(()=>[e(p,{class:"d-flex justify-start",cols:"4"},{default:n(()=>[B("Теги:")]),_:1}),e(p,{class:"text--secondary text-right",cols:"8"},{default:n(()=>[e(y,{"leave-absolute":""},{default:n(()=>[a.value.length===0?(l(),d("div",Ke,"Вкажіть теги")):a.value.length<=3?(l(),d("div",et,A(i.value),1)):(l(),d("div",tt,"вибрано "+A(a.value.length)+" тегів",1))]),_:1})]),_:1})]),_:1})]),_:1}),e(f,{class:"s-panel-text"},{default:n(()=>[e(h,{multiple:"",column:"",modelValue:a.value,"onUpdate:modelValue":c[0]||(c[0]=g=>a.value=g)},{default:n(()=>[(l(),d(M,null,Y(s,(g,S)=>e(r,{key:S,label:"",variant:"text",text:g,value:g},null,8,["text","value"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["value"])}}},ot=q(nt,[["__scopeId","data-v-8d54d543"]]),at={__name:"TheDateStep",emits:["done"],setup(m,{emit:o}){const a=D(),i=I(),s=I(!1),_=I(a.date??new Date),c=I();ne(()=>{i.value=a.getDate,a.getDate==="today"?c.value="Сьогодні":a.getDate==="yesterday"?c.value="Вчора":a.getDate==="tomorrow"?c.value="Завтра":(i.value="custom",c.value=a.getDate)});function p(){a.date=Ee(new Date,1),r()}function y(){a.date=new Date,r()}function $(){s.value=!0}function T(){a.date=_.value,s.value=!1,r()}function r(){a.nextStep()}return(h,f)=>{const x=t("v-col"),g=t("v-fade-transition"),S=t("v-row"),w=t("v-expansion-panel-title"),E=t("v-date-picker"),N=t("v-divider"),O=t("v-spacer"),V=t("v-btn"),C=t("v-card-actions"),L=t("v-card"),F=t("v-dialog"),R=t("v-chip"),X=t("v-chip-group"),Z=t("v-expansion-panel-text"),H=t("v-expansion-panel");return l(),k(H,{value:u(De)},{default:n(()=>[e(w,{"hide-actions":""},{default:n(({expanded:v})=>[e(S,{"no-gutters":""},{default:n(()=>[e(x,{class:"d-flex justify-start",cols:"4"},{default:n(()=>[B("Дата:")]),_:1}),e(x,{class:"text--secondary text-right",cols:"8"},{default:n(()=>[e(g,{"leave-absolute":""},{default:n(()=>[b("span",null,A(c.value),1)]),_:1})]),_:1})]),_:1})]),_:1}),e(Z,null,{default:n(()=>[e(F,{modelValue:s.value,"onUpdate:modelValue":f[2]||(f[2]=v=>s.value=v),"max-width":"600"},{default:n(()=>[e(L,null,{default:n(()=>[e(E,{modelValue:_.value,"onUpdate:modelValue":f[0]||(f[0]=v=>_.value=v),width:"100%",color:"primary"},null,8,["modelValue"]),e(N),e(C,null,{default:n(()=>[e(O),e(V,{text:"Відміна",variant:"plain",onClick:f[1]||(f[1]=v=>s.value=!1)}),e(V,{color:"primary",text:"Вибрати",variant:"tonal",onClick:T})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(X,{mandatory:"",modelValue:i.value,"onUpdate:modelValue":f[3]||(f[3]=v=>i.value=v)},{default:n(()=>[e(R,{label:"",variant:"text",text:"Вчора",value:"yesterday",onClick:p}),e(R,{label:"",variant:"text",text:"Сьогодні",value:"today",onClick:y}),e(R,{label:"",variant:"text",text:"Вибрати",value:"custom",onClick:$})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["value"])}}},lt={key:0},st={key:1},ct={key:"0",class:"text-grey"},ut={key:"1"},it={key:0,class:"text-truncate"},rt={class:"ml-1"},dt={key:0},_t={key:1},pt={class:"s-back-button-wrapper"},vt={__name:"TheAccountStep",props:ye({account:{type:Object,default:new K,validator:m=>m instanceof K},isValid:{type:Boolean,required:!0},isTransfer:{type:Boolean,default:!1},stepName:{type:String,default:Ue}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(m){const o=m,a=D(),i=ge(m,"modelValue");P(()=>a.typeId),Ce(()=>{o.isTransfer&&(i.value=null)});const s=I(!1),_=P(()=>Q.findLoaded()),c=I(null),p=I(new Q);function y(T){p.value=T,s.value=!0}function $(){s.value=!1}return(T,r)=>{const h=t("v-fade-transition"),f=t("v-col"),x=t("v-icon"),g=t("v-row"),S=t("v-expansion-panel-title"),w=t("v-chip"),E=t("v-chip-group"),N=t("v-btn"),O=t("v-expansion-panel-text"),V=t("v-expansion-panel");return l(),k(V,{value:m.stepName},{default:n(()=>[e(S,{"disable-icon-rotate":""},{default:n(({expanded:C})=>[e(g,{"no-gutters":""},{default:n(()=>[e(f,{cols:"4"},{default:n(()=>[e(h,{"leave-absolute":""},{default:n(()=>[u(a).typeId===u(ae)||m.isTransfer?(l(),d("span",lt,"На рахунок:")):(l(),d("span",st,"З рахунку:"))]),_:1})]),_:1}),e(f,{class:"text--secondary text-right",cols:"8"},{default:n(()=>[e(h,{"leave-absolute":""},{default:n(()=>[C?(l(),d("div",ct,"Вкажіть рахунок")):(l(),d("div",ut,[m.account.id?(l(),d("span",it,[e(x,{icon:m.account.icon},null,8,["icon"]),B(" "+A(m.account.name),1)])):U("",!0)]))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),actions:n(()=>[b("div",rt,[m.isValid?U("",!0):(l(),k(x,{key:0,color:"error",icon:"mdi-alert-circle"}))])]),_:1}),e(O,{class:"s-panel-text"},{default:n(()=>[e(h,{mode:"out-in"},{default:n(()=>[s.value?(l(),d("div",_t,[b("div",pt,[e(N,{size:"small",text:"Назад",onClick:oe($,["stop"])})]),e(E,{mandatory:"",column:"",modelValue:i.value,"onUpdate:modelValue":r[2]||(r[2]=C=>i.value=C)},{default:n(()=>[(l(!0),d(M,null,Y(p.value.accounts,C=>(l(),k(w,{key:C.id,label:"",variant:"text","prepend-icon":C.icon,text:C.name,value:C.id,onClick:r[1]||(r[1]=L=>u(a).nextStep())},null,8,["prepend-icon","text","value"]))),128))]),_:1},8,["modelValue"])])):(l(),d("div",dt,[e(E,{mandatory:"",column:"",modelValue:c.value,"onUpdate:modelValue":r[0]||(r[0]=C=>c.value=C)},{default:n(()=>[(l(!0),d(M,null,Y(_.value,C=>(l(),k(w,{key:C.id,label:"","prepend-icon":C.icon,variant:"text",text:C.name,value:C.id,onClick:L=>y(C)},null,8,["prepend-icon","text","value","onClick"]))),128))]),_:1},8,["modelValue"])]))]),_:1})]),_:1})]),_:1},8,["value"])}}},te=q(vt,[["__scopeId","data-v-1627dc4f"]]),mt={__name:"TheAccountsStepsChoice",setup(m){const o=D();return W(async()=>{await Q.loadTransactionPage()}),(a,i)=>(l(),d(M,null,[e(te,{modelValue:u(o).accountId,"onUpdate:modelValue":i[0]||(i[0]=s=>u(o).accountId=s),account:u(o).getAccount,"is-valid":u(o).isAccountValid},null,8,["modelValue","account","is-valid"]),u(o).typeId===u(G)?(l(),k(te,{key:0,modelValue:u(o).toAccountId,"onUpdate:modelValue":i[1]||(i[1]=s=>u(o).toAccountId=s),account:u(o).getToAccount,"is-valid":u(o).isToAccountValid,"is-transfer":!0,"step-name":u(Ne)},null,8,["modelValue","account","is-valid","step-name"])):U("",!0)],64))}},re=he("currencies",{state:()=>({loading:!1}),getters:{currencies:()=>ee.findLoaded()},actions:{async loadCurrencies(){if(this.currencies.length!==3){this.loading=!0;try{await ee.sync()}finally{this.loading=!1}}}}}),ft={key:"0",class:"text-grey"},xt={key:"1"},yt={class:"d-flex justify-end align-center pa-2"},gt={class:"text-h5"},Ct={__name:"TheToAmount",setup(m){const{toDecimal:o,toPlus:a,toInteger:i}=ue(),s=D(),_=re(),c=I(!1),p=P(()=>o(s.toAmount));W(()=>{y(),$()});function y(){J(s.toAmount)&&(s.toAmount=a(s.amount))}function $(){J(s.toCurrencyId)&&(s.toCurrencyId=s.currencyId)}return(T,r)=>{const h=t("v-col"),f=t("v-fade-transition"),x=t("v-row"),g=t("v-expansion-panel-title"),S=t("v-icon"),w=t("v-btn"),E=t("v-menu"),N=t("v-expansion-panel-text"),O=t("v-expansion-panel");return l(),k(O,{value:u(Pe)},{default:n(()=>[e(g,{"hide-actions":""},{default:n(({expanded:V})=>[e(x,{"no-gutters":""},{default:n(()=>[e(h,{class:"d-flex justify-start",cols:"4"},{default:n(()=>[B("Переказати:")]),_:1}),e(h,{class:"text--secondary text-right",cols:"8"},{default:n(()=>[e(f,{"leave-absolute":""},{default:n(()=>[V?(l(),d("span",ft,"Вкажіть суму зарахування")):(l(),d("span",xt,A(p.value)+" "+A(u(s).getToCurrency.symbol),1))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:1}),e(N,null,{default:n(()=>[b("div",yt,[b("div",{class:"text-right d-flex align-center",onClick:r[0]||(r[0]=V=>c.value=!0)},[b("span",gt,A(p.value),1),u(s).isAmountValid?U("",!0):(l(),k(S,{key:0,color:"error",icon:"mdi-alert-circle"}))]),e(E,null,{activator:n(({props:V})=>[e(w,le({variant:"flat",class:"s-btn"},V,{"append-icon":"mdi-chevron-down"}),{default:n(()=>[e(S,{icon:u(s).getToCurrency.icon},null,8,["icon"])]),_:2},1040)]),default:n(()=>[e(se,{currencies:u(_).currencies,onSelected:r[1]||(r[1]=V=>u(s).toCurrencyId=V.id)},null,8,["currencies"])]),_:1})]),e(ce,{modelValue:c.value,"onUpdate:modelValue":r[2]||(r[2]=V=>c.value=V),"start-sum":p.value,onDone:r[3]||(r[3]=V=>u(s).toAmount=u(i)(V))},null,8,["modelValue","start-sum"])]),_:1})]),_:1},8,["value"])}}},At={__name:"TheTransactionSteps",setup(m){const o=D();return(a,i)=>{const s=t("v-expansion-panels");return l(),d("div",null,[e(s,{modelValue:u(o).openStep,"onUpdate:modelValue":i[0]||(i[0]=_=>u(o).openStep=_),variant:"accordion",elevation:"0"},{default:n(()=>[e(je),e(mt),u(o).typeId!==u(G)?(l(),k(Je,{key:0})):U("",!0),u(o).typeId===u(G)?(l(),k(Ct,{key:1})):U("",!0),e(ot),e(at)]),_:1},8,["modelValue"])])}}},Dt={__name:"TheSaveButton",setup(m){const o=D(),a=ke(),i=I(!1);async function s(){if(o.isEnabledValidate=!0,!!o.isValid){i.value=!0;try{await _(),await a.push({name:"transactions.index"})}finally{i.value=!1}}}async function _(){const c=o.getTransaction;c.currency=o.currencyId,c.type=o.typeId,c.account=o.accountId,c.category=o.categoryId,c.amount=o.amount,c.note=null,c.transaction_at=Me(o.date),o.typeId===G&&(c.category=Te,c.to_account=o.toAccountId,c.to_currency=o.toCurrencyId,c.to_amount=o.toAmount),await c.save()}return(c,p)=>{const y=t("v-btn");return l(),d("div",null,[e(y,{loading:i.value,color:"primary",rounded:"t-0 b-xl",size:"x-large",text:"Continue",variant:"flat",block:"",onClick:s},null,8,["loading"])])}}},ht={class:"d-flex justify-end align-center pa-2"},kt={class:"text-h3"},Tt={__name:"TheCreateAmount",props:{amount:{type:[String,Number],default:"0"}},emits:["onClickOnAmount"],setup(m,{emit:o}){const a=o,i=D(),s=re();W(_);async function _(){await s.loadCurrencies()}return(c,p)=>{const y=t("v-icon"),$=t("v-btn"),T=t("v-menu");return l(),d("div",ht,[b("div",{class:"text-right mr-4 d-flex align-center",onClick:p[0]||(p[0]=r=>a("onClickOnAmount"))},[b("span",kt,A(m.amount),1),u(i).isAmountValid?U("",!0):(l(),k(y,{key:0,color:"error",icon:"mdi-alert-circle"}))]),e(T,null,{activator:n(({props:r})=>[e($,le({variant:"outlined",class:"s-btn"},r,{"append-icon":"mdi-chevron-down",loading:u(s).loading}),{default:n(()=>[e(y,{icon:u(i).getCurrency.icon},null,8,["icon"])]),_:2},1040,["loading"])]),default:n(()=>[e(se,{currencies:u(s).currencies,onSelected:p[1]||(p[1]=r=>u(i).currencyId=r.id)},null,8,["currencies"])]),_:1})])}}},St=q(Tt,[["__scopeId","data-v-2875c90d"]]),Et={__name:"TheAmount",props:{isCalcShow:{type:Boolean,default:!1}},setup(m){const o=m,a=D(),{toInteger:i,toMinus:s,toPlus:_,toDecimal:c}=ue(),p=I(o.isCalcShow),y=P(()=>_(c(a.amount))),$=P(()=>a.typeId);Se($,()=>{a.amount=T(a.amount)});const T=h=>{switch(a.typeId){case Ve:case G:return s(h);case ae:return _(h)}},r=h=>{a.amount=T(i(h))};return(h,f)=>(l(),d(M,null,[e(St,{amount:y.value,onOnClickOnAmount:f[0]||(f[0]=x=>p.value=!0)},null,8,["amount"]),e(ce,{modelValue:p.value,"onUpdate:modelValue":f[1]||(f[1]=x=>p.value=x),"start-sum":y.value,onDone:f[2]||(f[2]=x=>r(x))},null,8,["modelValue","start-sum"])],64))}};export{Et as _,At as a,Dt as b};
