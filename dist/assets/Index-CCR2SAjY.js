import{_ as T}from"./TransactionGroup-CjhYvjDY.js";import{T as v}from"./entities-BiPASufS.js";import{G as E,O as b,P as D,Q as S,R as M,m,q as P,r,o as i,d as p,w as f,c as _,b as L,e as h,s as U,k as d,S as B,F as N,y as w}from"./index-Dq0Qrvv2.js";const y=E("transaction/index",{state:()=>({meta:{},transactionsLoading:!1,loadUpdateMode:b,loadPageNumber:1,isFirstLoad:!0,isEmptyData:!1,isLoadLock:!1}),getters:{},actions:{async loadTransactions(){if(!this.isLoadLock){console.log("load categories"),this.transactionsLoading=!0,this.isLoadLock=!0;try{const a=await v.query().setUpdateMode(this.loadUpdateMode).setParams({include:"category,account",page:this.loadPageNumber}).get();F(this,a)}finally{this.transactionsLoading=!1,this.isLoadLock=!1}}}}});function F(a,e){var t;a.meta=e.data.meta,a.loadPageNumber=(((t=e.data.meta)==null?void 0:t.current_page)??0)+1,a.loadUpdateMode=D,a.isFirstLoad=!1,a.isEmptyData=S(e.data.data)}const A={key:0,class:"mt-8 h-3 text-center"},C={key:1},G={__name:"TheBottomLoading",setup(a){const e=M(),t=y(),u=m(()=>e.offsetBottom<200&&!t.isFirstLoad),l=m(()=>e.offsetBottom<180);return P(l,c=>{c===!0&&!t.isEmptyData&&t.loadTransactions()}),(c,o)=>{const s=r("v-progress-circular"),n=r("v-fade-transition");return i(),p(n,null,{default:f(()=>[u.value?(i(),_("div",A,[L(t).transactionsLoading?(i(),p(s,{key:0,indeterminate:""})):L(t).isEmptyData?(i(),_("div",C," Більше транзакцій немає ")):h("",!0)])):h("",!0)]),_:1})}}},z={__name:"Index",setup(a){const e=y(),t=m(()=>l(v.findLoaded()));U(u);function u(){e.loadTransactions()}function l(o){return Object.values(o.reduce(c,{}))}function c(o,s){const n=s.transaction_at_date;return B(o[n])&&(o[n]={date:s.transaction_at_date,timestamp:s.transaction_at_timestamp,transactions:[]}),o[n].transactions.push(s),o}return(o,s)=>{const n=r("v-fab"),k=r("v-card-text"),x=r("v-card");return i(),_("div",null,[d(x,{loading:L(e).transactionsLoading},{default:f(()=>[d(k,null,{default:f(()=>[(i(!0),_(N,null,w(t.value,g=>(i(),p(T,{key:g.timestamp,group:g},null,8,["group"]))),128)),d(G),d(n,{app:"",icon:"mdi-plus",class:"mb-14",to:{name:"transactions.create"}})]),_:1})]),_:1},8,["loading"])])}}};export{z as default};
