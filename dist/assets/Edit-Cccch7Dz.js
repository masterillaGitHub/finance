import{u as E,a as C}from"./form.store-B7goqM2Q.js";import{_ as w}from"./BottomConfirm-Da1d_FVv.js";import{h,i as y,r as s,o as l,c as I,j as t,w as T,F as S,m as $,y as b,K as k,S as A,T as B,R as N,d as D,a as F}from"./index-CMFz-0SU.js";import{u as P,_ as V,a as M,b as Y}from"./TheAmount-E-kuMrXA.js";import{T as U}from"./entities-DwYTsaLf.js";import{u as j}from"./currency_decimal_convert-KKbzYINo.js";import"./CurrenciesList-DOV7E-pJ.js";import"./Model-CeNXf-rt.js";const q={__name:"TheAppBar",emits:["removeTransaction"],setup(R,{emit:m}){E();const d=h(),_=m,n=y(!1);function p(){_("removeTransaction"),d.push({name:"transactions.index"})}return(v,a)=>{const e=s("v-btn"),f=s("v-spacer"),g=s("v-app-bar");return l(),I(S,null,[t(g,{elevation:2,density:"compact"},{prepend:T(()=>[t(e,{icon:"mdi-arrow-left",to:{name:"transactions.index"}})]),default:T(()=>[t(f),t(e,{class:"text-red",icon:"mdi-delete-outline",size:"large",variant:"plain",onClick:a[0]||(a[0]=c=>n.value=!0)})]),_:1}),t(w,{modelValue:n.value,"onUpdate:modelValue":a[1]||(a[1]=c=>n.value=c),title:"Видалити?",onSuccess:p},null,8,["modelValue"])],64)}}},z={key:1,class:"fill-height d-flex flex-column"},W={__name:"Edit",props:{id:{type:[Number,String],required:!0}},setup(R){const m=R,{toMinus:d,toPlus:_}=j(),n=C(),p=P(),v=y(),a=y(!0),e=$(()=>U.find(v.value));b(f),k(()=>{n.reset()});async function f(){a.value=!0;try{v.value=await p.loadTransactionById(m.id),g()}finally{a.value=!1}}function g(){var o,r,i,u;n.$patch({amount:c(e.value.amount),currencyId:e.value.getRelation("currency"),typeId:e.value.getRelation("type"),accountId:e.value.getRelation("account"),categoryId:e.value.getRelation("category"),tagIds:e.value.getRelation("tags"),date:new Date(e.value.transaction_at_timestamp*1e3),toAccountId:(o=e.value.transfer_transaction)==null?void 0:o.getRelation("account"),toCurrencyId:(r=e.value.transfer_transaction)==null?void 0:r.getRelation("currency"),toAmount:(i=e.value.transfer_transaction)==null?void 0:i.amount,transactionId:e.value.id,transferTransactionId:(u=e.value.transfer_transaction)==null?void 0:u.id})}const c=o=>{switch(e.value.getRelation("type")){case N:case B:return d(o);case A:return _(o)}},x=()=>{e.value.destroy()};return(o,r)=>{const i=s("v-progress-linear"),u=s("v-fade-transition");return l(),I(S,null,[t(q,{onRemoveTransaction:x}),t(u,{mode:"out-in"},{default:T(()=>[a.value?(l(),D(i,{key:0,indeterminate:""})):(l(),I("div",z,[r[0]||(r[0]=F("div",{class:"flex-grow-1"},null,-1)),t(V),t(M),t(Y)]))]),_:1})],64)}}};export{W as default};
