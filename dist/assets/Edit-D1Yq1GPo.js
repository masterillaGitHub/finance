import{u as S,a as C}from"./form.store-DSTuMn-H.js";import{_ as w}from"./BottomConfirm-aw5yHlbj.js";import{h,i as g,r as s,o as l,c as I,j as t,w as T,F as x,m as $,y as b,L as k,V as A,Q as B,U as N,d as V,a as D}from"./index-msQYrNo8.js";import{u as F,_ as P,a as M,b as U}from"./TheAmount-BIhZ5V8e.js";import{T as Y}from"./entities-Be7q-u-Q.js";import{u as L}from"./currency_decimal_convert-KKbzYINo.js";import"./CurrenciesList-CU0bJNLd.js";import"./Model-52kJW6XD.js";const j={__name:"TheAppBar",emits:["removeTransaction"],setup(R,{emit:m}){S();const d=h(),_=m,n=g(!1);function p(){_("removeTransaction"),d.push({name:"transactions.index"})}return(v,a)=>{const e=s("v-btn"),f=s("v-spacer"),y=s("v-app-bar");return l(),I(x,null,[t(y,{elevation:2,density:"compact"},{prepend:T(()=>[t(e,{icon:"mdi-arrow-left",to:{name:"transactions.index"}})]),default:T(()=>[t(f),t(e,{class:"text-red",icon:"mdi-delete-outline",size:"large",variant:"plain",onClick:a[0]||(a[0]=c=>n.value=!0)})]),_:1}),t(w,{modelValue:n.value,"onUpdate:modelValue":a[1]||(a[1]=c=>n.value=c),title:"Видалити?",onSuccess:p},null,8,["modelValue"])],64)}}},q={key:1,class:"fill-height d-flex flex-column"},W={__name:"Edit",props:{id:{type:[Number,String],required:!0}},setup(R){const m=R,{toMinus:d,toPlus:_}=L(),n=C(),p=F(),v=g(),a=g(!0),e=$(()=>Y.find(v.value));b(f),k(()=>{n.reset()});async function f(){a.value=!0;try{v.value=await p.loadTransactionById(m.id),y()}finally{a.value=!1}}function y(){var o,r,i,u;n.$patch({amount:c(e.value.amount),currencyId:e.value.getRelation("currency"),typeId:e.value.getRelation("type"),accountId:e.value.getRelation("account"),categoryId:e.value.getRelation("category"),description:e.value.description,tagIds:e.value.getRelation("tags"),date:new Date(e.value.transaction_at_timestamp*1e3),note:e.value.note,toAccountId:(o=e.value.transfer_transaction)==null?void 0:o.getRelation("account"),toCurrencyId:(r=e.value.transfer_transaction)==null?void 0:r.getRelation("currency"),toAmount:(i=e.value.transfer_transaction)==null?void 0:i.amount,transactionId:e.value.id,transferTransactionId:(u=e.value.transfer_transaction)==null?void 0:u.id})}const c=o=>{switch(e.value.getRelation("type")){case N:case B:return d(o);case A:return _(o)}},E=()=>{e.value.destroy()};return(o,r)=>{const i=s("v-progress-linear"),u=s("v-fade-transition");return l(),I(x,null,[t(j,{onRemoveTransaction:E}),t(u,{mode:"out-in"},{default:T(()=>[a.value?(l(),V(i,{key:0,indeterminate:""})):(l(),I("div",q,[r[0]||(r[0]=D("div",{class:"flex-grow-1"},null,-1)),t(P,{readonly:!0}),t(M),t(U)]))]),_:1})],64)}}};export{W as default};
