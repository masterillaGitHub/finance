import{u as S,a as C}from"./form.store-Cgi7iU6w.js";import{_ as h}from"./BottomConfirm-NmrKO6uR.js";import{h as A,i as v,r as o,o as l,c as y,j as e,w as g,F as E,m as D,y as N,K as P,S as $,U as b,T as k,R as M,d as B,a as F}from"./index-CECwDoZT.js";import{_ as U,a as V,b as Y}from"./TheAmount-DlBYcBMo.js";import{T as I}from"./entities-a6JjP9x7.js";import{u as j}from"./currency_decimal_convert-KKbzYINo.js";import"./CurrenciesList-CLAsWoEH.js";import"./Model-m4MKmFK9.js";const q={__name:"TheAppBar",emits:["removeTransaction"],setup(T,{emit:m}){S();const d=A(),_=m,a=v(!1);function r(){_("removeTransaction"),d.push({name:"transactions.index"})}return(s,t)=>{const c=o("v-btn"),p=o("v-spacer"),f=o("v-app-bar");return l(),y(E,null,[e(f,{elevation:2,density:"compact"},{prepend:g(()=>[e(c,{icon:"mdi-arrow-left",to:{name:"transactions.index"}})]),default:g(()=>[e(p),e(c,{class:"text-red",icon:"mdi-delete-outline",size:"large",variant:"plain",onClick:t[0]||(t[0]=i=>a.value=!0)})]),_:1}),e(h,{modelValue:a.value,"onUpdate:modelValue":t[1]||(t[1]=i=>a.value=i),title:"Видалити?",onSuccess:r},null,8,["modelValue"])],64)}}},L={key:1,class:"fill-height d-flex flex-column"},W={__name:"Edit",props:{id:{type:[Number,String],required:!0}},setup(T){const m=T,{toMinus:d,toPlus:_}=j(),a=C(),r=v(),s=v(!0),t=D(()=>I.find(r.value));N(c),P(()=>{a.reset()});async function c(){s.value=!0;try{await p(),f()}finally{s.value=!1}}async function p(){const n=["category","account","currency","type","tags","transfer_transaction.category","transfer_transaction.currency","transfer_transaction.type","transfer_transaction.account"],u=await I.query().setUpdateMode($).setParams({include:n.join(","),"filter[id]":m.id}).get();r.value=u.data.data[0]}function f(){a.$patch({amount:i(t.value.amount),currencyId:t.value.getRelation("currency"),typeId:t.value.getRelation("type"),accountId:t.value.getRelation("account"),categoryId:t.value.getRelation("category"),tagIds:t.value.getRelation("tags"),date:new Date(t.value.transaction_at_timestamp*1e3),toAccountId:t.value.transfer_transaction.getRelation("account"),toCurrencyId:t.value.transfer_transaction.getRelation("currency"),toAmount:t.value.transfer_transaction.amount,transactionId:t.value.id,transferTransactionId:t.value.transfer_transaction.id})}const i=n=>{switch(t.value.getRelation("type")){case M:case k:return d(n);case b:return _(n)}},R=()=>{t.value.destroy()};return(n,u)=>{const x=o("v-progress-linear"),w=o("v-fade-transition");return l(),y(E,null,[e(q,{onRemoveTransaction:R}),e(w,{mode:"out-in"},{default:g(()=>[s.value?(l(),B(x,{key:0,indeterminate:""})):(l(),y("div",L,[u[0]||(u[0]=F("div",{class:"flex-grow-1"},null,-1)),e(U),e(V),e(Y)]))]),_:1})],64)}}};export{W as default};
